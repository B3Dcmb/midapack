<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MIDAPACK - MIcrowave Data Analysis PACKage: Data structure and parallelism</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoANR-MIDAS09_quarter.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MIDAPACK - MIcrowave Data Analysis PACKage
   &#160;<span id="projectnumber">1.1b</span>
   </div>
   <div id="projectbrief">Parallel software tools for high performance CMB DA analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('data_struct_parall.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Data structure and parallelism </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="input_struct"></a>
Parallel sparse matrix</h1>
<p>Considering a matrix <img class="formulaInl" alt="$A$" src="form_6.png"/>, parallelism assume <img class="formulaInl" alt="$A$" src="form_6.png"/> is row-distributed over processes. Each processor has into memory m rows of the global matrix. Reciprocally <img class="formulaInl" alt="$A^t$" src="form_7.png"/> is column-distributed, with m columns into memory. That is to say </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \left( \begin{array}{c}A_0 \\A_1\\ \vdots \\ A_{n_{prc}-1} \end{array} \right) \]" src="form_8.png"/>
</p>
<p> Reciprocally </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A^t=(A_0^t, A_1^t, A_2^t, ... A_{n_{prc}-1}^t) \]" src="form_9.png"/>
</p>
<p>As <img class="formulaInl" alt="$A$" src="form_6.png"/> is a sparse martix, it doesn't store zero values. Furthermore we assume <img class="formulaInl" alt="$A$" src="form_6.png"/> is exactly nnz nonzerovalues. Then building matrix A only require these non-zero values and theirs global columns indices, also called ELL format. Input data consists in two large tab of size m*nnz, where rows are concatenated. This input array have to be passed when calling matrix initializtaion function.</p>
<p>To well balance the load over processes we have to ensure number of rows time number of non-zero per row is roughly the same on each processor. <br  />
</p>
<h1><a class="anchor" id="input_example"></a>
Input data</h1>
<p>The two following examples illustrate the input data needs to build a matrix using <a class="el" href="group__matmap__group11.html#ga38bb561b83b6df1660a4b0fe09ad13f5">MatInit. </a> The first one is a sequential, the second consider 2 processors.</p><ul>
<li>sequential case : m=8, nnz=2, indices=[0 1 2 4 0 2 0 2 2 3 3 4 1 4 1 3], values=[1 7 2 8 5 3 5 6 2 9 8 6 1 3 6 4]. <p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \left( \begin{array}{ccccc}1&amp;7&amp;0&amp;0&amp;0\\0&amp;0&amp;2&amp;0&amp;8\\5&amp;0&amp;3&amp;0&amp;0\\5&amp;0&amp;2&amp;0&amp;0\\0&amp;0&amp;2&amp;9&amp;0\\0&amp;0&amp;0&amp;8&amp;6\\0&amp;1&amp;0&amp;0&amp;3\\0&amp;6&amp;0&amp;4&amp;0\end{array} \right) \]" src="form_10.png"/>
</p>
</li>
<li>parallel case over 2 processors : input data on processor 0 is m=3, nnz=2, indices=[0 1 2 4 0 2 0 2], values=[1 7 2 8 5 3 5 6]. Input data on processor 1 is m=4, nnz=2, indices=[2 3 3 4 1 4 1 3], values=[2 9 8 6 1 3 6 4]. <p class="formulaDsp">
<img class="formulaDsp" alt="\[ A = \left( \begin{array}{c} A_0 \\ A_1 \end{array} \right) \]" src="form_11.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_0 = \left( \begin{array}{ccccc} 1&amp;7&amp;0&amp;0&amp;0\\0&amp;0&amp;2&amp;0&amp;8\\5&amp;0&amp;3&amp;0&amp;0\\5&amp;0&amp;2&amp;0&amp;0\end{array} \right) , A_1 = \left( \begin{array}{ccccc} 0&amp;0&amp;2&amp;9&amp;0\\0&amp;0&amp;0&amp;8&amp;6\\0&amp;1&amp;0&amp;0&amp;3\\0&amp;6&amp;0&amp;4&amp;0\end{array} \right) \]" src="form_12.png"/>
</p>
 Two remarks about the input data structure (ELL format) :<ul>
<li>It happens that a row has more or less non-zero values than nnz. In this case we can choose the greater nnz and add zero wherever it is necessary with whatever index. For performance we advise to choose an index which has already a value in the row.</li>
<li>ELL format is more general than DIA format since non-zero elements of given row do not need to be ordered. Thus permuting non-zero elements of given row in the input data do not change the matrix.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="intern_struct"></a>
Internal data stucture</h1>
<p>The internal structure is more sophisticated than the ELL format. Especially, to enhance matrix operations performance, a precomputation step reshapes the data structure into several arrays : global ordered columns indices, local indices, communication ...</p>
<p>When using MatInit function, precomputation is performed blindly. Nevertheless, for advanced users it is possible to initialize a matrix in several steps. This enables to specify differents methods for the precomputations.</p><ul>
<li>set non-zero elements indices and values (<a class="el" href="group__matmap__group11.html#gaaf26c7678367e6757392c03abd22a105">MatSetIndices </a> <a class="el" href="group__matmap__group11.html#gad3d5adb742e7a82454fcd6eede21da91">MatSetValues </a>),</li>
<li>reindex local matrix (<a class="el" href="group__matmap__group11.html#gae31f7ccb10cda5c97e49f640feed1ad4">MatLocalShape </a>),</li>
<li>create communication scheme (<a class="el" href="group__matmap__group11.html#ga61b3b348d7c039aadfc3196e6b83535a">MatComShape </a>).</li>
</ul>
<p><br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">General introduction</a></li><li class="navelem"><a class="el" href="pointing.html">Pointing operations documentation</a></li>
    <li class="footer">Generated on Fri May 5 2023 23:48:10 for MIDAPACK - MIcrowave Data Analysis PACKage by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
