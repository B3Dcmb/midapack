<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MIDAPACK - MIcrowave Data Analysis PACKage: low-level routines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoANR-MIDAS09_quarter.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MIDAPACK - MIcrowave Data Analysis PACKage
   &#160;<span id="projectnumber">1.1b</span>
   </div>
   <div id="projectbrief">Parallel software tools for high performance CMB DA analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__group21.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">low-level routines<div class="ingroups"><a class="el" href="group__toeplitz.html">TOEPLITZ module</a> &raquo; <a class="el" href="group__group2.html">internal routines</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga186fc8d8825da293e94de77b77d01fba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga186fc8d8825da293e94de77b77d01fba">define_blocksize</a> (int n, int lambda, int bs_flag, int fixed_bs)</td></tr>
<tr class="memdesc:ga186fc8d8825da293e94de77b77d01fba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines an optimal size of the block used in the sliding windows algorithm.  <a href="group__group21.html#ga186fc8d8825da293e94de77b77d01fba">More...</a><br /></td></tr>
<tr class="separator:ga186fc8d8825da293e94de77b77d01fba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c2846ca9f67faae5746325d1ec63aac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga4c2846ca9f67faae5746325d1ec63aac">define_nfft</a> (int n_thread, int flag_nfft, int fixed_nfft)</td></tr>
<tr class="memdesc:ga4c2846ca9f67faae5746325d1ec63aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the number of simultaneous ffts for the Toeplitz matrix product computation.  <a href="group__group21.html#ga4c2846ca9f67faae5746325d1ec63aac">More...</a><br /></td></tr>
<tr class="separator:ga4c2846ca9f67faae5746325d1ec63aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae3d694bcffacaf24706f0586a223538e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#gae3d694bcffacaf24706f0586a223538e">fftw_init_omp_threads</a> (int fftw_n_thread)</td></tr>
<tr class="memdesc:gae3d694bcffacaf24706f0586a223538e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize omp threads for fftw plans.  <a href="group__group21.html#gae3d694bcffacaf24706f0586a223538e">More...</a><br /></td></tr>
<tr class="separator:gae3d694bcffacaf24706f0586a223538e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a6106fbaa68aab85595935252299097"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga1a6106fbaa68aab85595935252299097">rhs_init_fftw</a> (int *nfft, int fft_size, fftw_complex **V_fft, double **V_rfft, fftw_plan *plan_f, fftw_plan *plan_b, int fftw_flag)</td></tr>
<tr class="memdesc:ga1a6106fbaa68aab85595935252299097"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes fftw array and plan for the right hand side, general matrix V.  <a href="group__group21.html#ga1a6106fbaa68aab85595935252299097">More...</a><br /></td></tr>
<tr class="separator:ga1a6106fbaa68aab85595935252299097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c68921dafc6dc184d335a59df68e5f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga6c68921dafc6dc184d335a59df68e5f7">circ_init_fftw</a> (double *T, int fft_size, int lambda, fftw_complex **T_fft)</td></tr>
<tr class="memdesc:ga6c68921dafc6dc184d335a59df68e5f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes fftw array and plan for the circulant matrix T_circ obtained from T.  <a href="group__group21.html#ga6c68921dafc6dc184d335a59df68e5f7">More...</a><br /></td></tr>
<tr class="separator:ga6c68921dafc6dc184d335a59df68e5f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2c399885221722e98f72206ddce8d0d3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga2c399885221722e98f72206ddce8d0d3">scmm_direct</a> (int fft_size, int nfft, fftw_complex *C_fft, int ncol, double *V_rfft, double **CV, fftw_complex *V_fft, fftw_plan plan_f_V, fftw_plan plan_b_CV)</td></tr>
<tr class="memdesc:ga2c399885221722e98f72206ddce8d0d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the product of a circulant matrix C_fft by a matrix V_rfft using fftw plans.  <a href="group__group21.html#ga2c399885221722e98f72206ddce8d0d3">More...</a><br /></td></tr>
<tr class="separator:ga2c399885221722e98f72206ddce8d0d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab8839f416f8f8165b31a5363c405428d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#gab8839f416f8f8165b31a5363c405428d">scmm_basic</a> (double **V, int blocksize, int m, fftw_complex *C_fft, double **CV, fftw_complex *V_fft, double *V_rfft, int nfft, fftw_plan plan_f_V, fftw_plan plan_b_CV)</td></tr>
<tr class="memdesc:gab8839f416f8f8165b31a5363c405428d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the product of a circulant matrix by a matrix using FFT's (an INTERNAL routine)  <a href="group__group21.html#gab8839f416f8f8165b31a5363c405428d">More...</a><br /></td></tr>
<tr class="separator:gab8839f416f8f8165b31a5363c405428d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2731f1bbfce2d47c4cc3381150470da4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga2731f1bbfce2d47c4cc3381150470da4">stmm_core</a> (double **V, int n, int m, double *T, fftw_complex *T_fft, int blocksize, int lambda, fftw_complex *V_fft, double *V_rfft, int nfft, fftw_plan plan_f, fftw_plan plan_b, int flag_offset, int flag_nofft)</td></tr>
<tr class="memdesc:ga2731f1bbfce2d47c4cc3381150470da4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. (an INTERNAL routine)  <a href="group__group21.html#ga2731f1bbfce2d47c4cc3381150470da4">More...</a><br /></td></tr>
<tr class="separator:ga2731f1bbfce2d47c4cc3381150470da4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gace7322011cd24b469e9b5d530e8a71ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#gace7322011cd24b469e9b5d530e8a71ba">stmm_main</a> (double **V, int n, int m, int id0, int l, double *T, fftw_complex *T_fft, int lambda, fftw_complex *V_fft, double *V_rfft, fftw_plan plan_f, fftw_plan plan_b, int blocksize, int nfft, <a class="el" href="structFlag.html">Flag</a> flag_stgy)</td></tr>
<tr class="memdesc:gace7322011cd24b469e9b5d530e8a71ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the product of a Toeplitz matrix by a general matrix using the sliding window algorithm with optimize reshaping. (an INTERNAL routine)  <a href="group__group21.html#gace7322011cd24b469e9b5d530e8a71ba">More...</a><br /></td></tr>
<tr class="separator:gace7322011cd24b469e9b5d530e8a71ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf6b3f49e179ac9ed28354ddd7dbb6a04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#gaf6b3f49e179ac9ed28354ddd7dbb6a04">build_gappy_blocks</a> (int nrow, int m, <a class="el" href="structBlock.html">Block</a> *tpltzblocks, int nb_blocks_local, int nb_blocks_all, int64_t *id0gap, int *lgap, int ngap, <a class="el" href="structBlock.html">Block</a> *tpltzblocks_gappy, int *nb_blocks_gappy_final, int flag_param_distmin_fixed)</td></tr>
<tr class="memdesc:gaf6b3f49e179ac9ed28354ddd7dbb6a04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the gappy Toeplitz block structure to optimise the product computation at gaps location.  <a href="group__group21.html#gaf6b3f49e179ac9ed28354ddd7dbb6a04">More...</a><br /></td></tr>
<tr class="separator:gaf6b3f49e179ac9ed28354ddd7dbb6a04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf19f51ef406bebdb5e9400b6f9962077"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#gaf19f51ef406bebdb5e9400b6f9962077">stmm_simple_basic</a> (double **V, int n, int m, double *T, int lambda, double **TV)</td></tr>
<tr class="memdesc:gaf19f51ef406bebdb5e9400b6f9962077"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the product of a Toeplitz matrix by a matrix without using FFT's.  <a href="group__group21.html#gaf19f51ef406bebdb5e9400b6f9962077">More...</a><br /></td></tr>
<tr class="separator:gaf19f51ef406bebdb5e9400b6f9962077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga516de87d3daf22f1a29ba390d5e57caa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga516de87d3daf22f1a29ba390d5e57caa">stmm_simple_core</a> (double **V, int n, int m, double *T, int blocksize, int lambda, int nfft, int flag_offset)</td></tr>
<tr class="memdesc:ga516de87d3daf22f1a29ba390d5e57caa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm.  <a href="group__group21.html#ga516de87d3daf22f1a29ba390d5e57caa">More...</a><br /></td></tr>
<tr class="separator:ga516de87d3daf22f1a29ba390d5e57caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga234bcc963a99bea09ed92b36c711c3ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga234bcc963a99bea09ed92b36c711c3ec">flag_stgy_init_auto</a> (<a class="el" href="structFlag.html">Flag</a> *flag_stgy)</td></tr>
<tr class="memdesc:ga234bcc963a99bea09ed92b36c711c3ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the flag to automatic paramaters.  <a href="group__group21.html#ga234bcc963a99bea09ed92b36c711c3ec">More...</a><br /></td></tr>
<tr class="separator:ga234bcc963a99bea09ed92b36c711c3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6de858af090da4b96df6a195015ce09e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga6de858af090da4b96df6a195015ce09e">flag_stgy_init_zeros</a> (<a class="el" href="structFlag.html">Flag</a> *flag_stgy)</td></tr>
<tr class="memdesc:ga6de858af090da4b96df6a195015ce09e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the flag parameters to zeros. This is almost the same as automatic.  <a href="group__group21.html#ga6de858af090da4b96df6a195015ce09e">More...</a><br /></td></tr>
<tr class="separator:ga6de858af090da4b96df6a195015ce09e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae334670891033aa91dd0bb7f8b707dc4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#gae334670891033aa91dd0bb7f8b707dc4">flag_stgy_init_defined</a> (<a class="el" href="structFlag.html">Flag</a> *flag_stgy)</td></tr>
<tr class="memdesc:gae334670891033aa91dd0bb7f8b707dc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the parameters flag to the defined ones.  <a href="group__group21.html#gae334670891033aa91dd0bb7f8b707dc4">More...</a><br /></td></tr>
<tr class="separator:gae334670891033aa91dd0bb7f8b707dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2d566ebeba6474d1bbac93315e1f578a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group21.html#ga2d566ebeba6474d1bbac93315e1f578a">print_flag_stgy_init</a> (<a class="el" href="structFlag.html">Flag</a> flag_stgy)</td></tr>
<tr class="memdesc:ga2d566ebeba6474d1bbac93315e1f578a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the flag parameters values.  <a href="group__group21.html#ga2d566ebeba6474d1bbac93315e1f578a">More...</a><br /></td></tr>
<tr class="separator:ga2d566ebeba6474d1bbac93315e1f578a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These are low-level routines. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga186fc8d8825da293e94de77b77d01fba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga186fc8d8825da293e94de77b77d01fba">&#9670;&nbsp;</a></span>define_blocksize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int define_blocksize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bs_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fixed_bs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines an optimal size of the block used in the sliding windows algorithm. </p>
<p>The optimal block size is computed as the minimum power of two above 3*lambda, i.e. the smallest value equal to 2^x, where x is an integer, and above 3*lambda. If bs_flag is set to one, a different formula is used to compute the optimal block size (see MADmap: A MASSIVELY PARALLEL MAXIMUM LIKELIHOOD COSMIC MICROWAVE BACKGROUND MAP-MAKER, C. M. Cantalupo, J. D. Borrill, A. H. Jaffe, T. S. Kisner, and R. Stompor, The Astrophysical Journal Supplement Series, 187:212â€“227, 2010 March). To avoid using block size much bigger than the matrix, the block size is set to 3*lambda when his previous computed size is bigger than the matrix size n. This case append mostly for small matrix compared to his bandwith. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>matrix row dimension </td></tr>
    <tr><td class="paramname">lambda</td><td>half bandwidth of the Toeplitz matrix </td></tr>
    <tr><td class="paramname">bs_flag</td><td>flag to use a different formula for optimal block size computation </td></tr>
    <tr><td class="paramname">fixed_bs</td><td>fixed blocksize value if needed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00130">130</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="ga4c2846ca9f67faae5746325d1ec63aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4c2846ca9f67faae5746325d1ec63aac">&#9670;&nbsp;</a></span>define_nfft()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int define_nfft </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fixed_nfft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the number of simultaneous ffts for the Toeplitz matrix product computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n_thread</td><td>number of omp threads </td></tr>
    <tr><td class="paramname">flag_nfft</td><td>flag to set the strategy to define nfft </td></tr>
    <tr><td class="paramname">fixed_nfft</td><td>fixed nfft value if nedeed (used for the case where flag_nfft=1) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00220">220</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="gae3d694bcffacaf24706f0586a223538e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae3d694bcffacaf24706f0586a223538e">&#9670;&nbsp;</a></span>fftw_init_omp_threads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fftw_init_omp_threads </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fftw_n_thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize omp threads for fftw plans. </p>
<p>Initialize omp threads for fftw plans. The number of threads used for ffts (define by the variable n_thread) is read from OMP_NUM_THREAD environment variable. fftw multithreaded option is controlled by fftw_MULTITHREADING macro. </p>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00333">333</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="ga1a6106fbaa68aab85595935252299097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a6106fbaa68aab85595935252299097">&#9670;&nbsp;</a></span>rhs_init_fftw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rhs_init_fftw </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex **&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>plan_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>plan_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fftw_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes fftw array and plan for the right hand side, general matrix V. </p>
<p>Initialize fftw array and plan for the right hand side matrix V. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nfft</td><td>maximum number of FFTs you want to compute at the same time </td></tr>
    <tr><td class="paramname">fft_size</td><td>effective FFT size for the general matrix V (usually equal to blocksize) </td></tr>
    <tr><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramname">plan_f</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramname">plan_b</td><td>fftw plan backward (c2r) </td></tr>
    <tr><td class="paramname">fftw_flag</td><td>fftw plan allocation flag </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00365">365</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="ga6c68921dafc6dc184d335a59df68e5f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6c68921dafc6dc184d335a59df68e5f7">&#9670;&nbsp;</a></span>circ_init_fftw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circ_init_fftw </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex **&#160;</td>
          <td class="paramname"><em>T_fft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes fftw array and plan for the circulant matrix T_circ obtained from T. </p>
<p>Builds the circulant matrix T_circ from T and initilizes its fftw arrays and plans. Use tpltz_cleanup afterwards. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__group11.html#gac7ac0ee5f6eaee6846814b131671f6e8" title="Cleans fftw workspace used in the Toeplitz matrix matrix product&#39;s computation.">tpltz_cleanup</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">T</td><td>Toeplitz matrix. </td></tr>
    <tr><td class="paramname">fft_size</td><td>effective FFT size for the circulant matrix (usually equal to blocksize) </td></tr>
    <tr><td class="paramname">lambda</td><td>Toeplitz band width. </td></tr>
    <tr><td class="paramname">T_fft</td><td>complex array used for FFTs. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00392">392</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="ga2c399885221722e98f72206ddce8d0d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2c399885221722e98f72206ddce8d0d3">&#9670;&nbsp;</a></span>scmm_direct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scmm_direct </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>C_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>CV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_f_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_b_CV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the product of a circulant matrix C_fft by a matrix V_rfft using fftw plans. </p>
<p>Performs the product of a circulant matrix C_fft by a matrix V_rfft using fftw plans: forward - plan_f_V; and backward - plan_b_CV. C_fft is a Fourier (complex representation of the circulant matrix) of length fft_size/2+1; V_rfft is a matrix with ncol columns and fft_size rows; V_fft is a workspace of fft_size/2+1 complex numbers as required by the backward FFT (plan_b_CV); CV is the output matrix of the same size as the input V_rfft one. The FFTs transform ncol vectors simultanously. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">fft_size</td><td>row dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nfft</td><td>number of simultaneous FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">C_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ncol</td><td>column dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CV</td><td>product of the circulant matrix C_fft by the matrix V_rfft </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plan_f_V</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plan_b_CV</td><td>fftw plan backward (c2r) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00511">511</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="gab8839f416f8f8165b31a5363c405428d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab8839f416f8f8165b31a5363c405428d">&#9670;&nbsp;</a></span>scmm_basic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scmm_basic </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>C_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>CV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_f_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_b_CV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the product of a circulant matrix by a matrix using FFT's (an INTERNAL routine) </p>
<p>This routine multiplies a circulant matrix, represented by C_fft, by a general matrix V, and stores the output as a matrix CV. In addition the routine requires two workspace objects, V_fft and V_rfft, to be allocated prior to a call to it as well as two fftw plans: one forward (plan_f_V), and one backward (plan_b_TV). The sizes of the input general matrix V and the ouput CV are given by blocksize rows and m columns. They are stored as a vector in the column-wise order. The circulant matrix, which is assumed to be band-diagonal with a band-width lambda, is represented by a Fourier transform with its coefficients stored in a vector C_fft (length blocksize). blocksize also defines the size of the FFTs, which will be performed and therefore this is the value which has to be used while creating the fftw plans and allocating the workspaces. The latter are given as: nfft*(blocksize/2+1) for V_fft and nfft*blocksize for V_rfft. The fftw plans should correspond to doing the transforms of nfft vectors simultaneously. Typically, the parameters of this routine are fixed by a preceding call to Toeplitz_init(). The parameters are : </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">V</td><td>matrix (with the convention V(i,j)=V[i+j*n]) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">blocksize</td><td>row dimension of V </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">m</td><td>column dimension of V </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">C_fft</td><td>complex array used for FFTs (FFT of the Toeplitz matrix) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CV</td><td>product of the circulant matrix C_fft by the matrix V_rfft </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nfft</td><td>number of simultaneous FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plan_f_V</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plan_b_CV</td><td>fftw plan backward (c2r) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00589">589</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="ga2731f1bbfce2d47c4cc3381150470da4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2731f1bbfce2d47c4cc3381150470da4">&#9670;&nbsp;</a></span>stmm_core()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stmm_core </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>T_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_nofft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. (an INTERNAL routine) </p>
<p>The product is performed block-by-block with a defined block size or a computed optimized block size that reflects a trade off between cost of a single FFT of a length block_size and a number of blocks needed to perform the mutiplicaton. The latter determines how many spurious values are computed extra due to overlaps between the blocks. Use flag_offset=0 for "classic" algorithm and flag_offset=1 to put an offset to avoid the first and last lambdas terms. Usefull when a reshaping was done before with optimal column for a nfft. Better be inside the arguments of the routine. The parameters are: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">V</td><td><b></b>[input] data matrix (with the convention V(i,j)=V[i+j*n]) ; <b></b>[out] result of the product TV </td></tr>
    <tr><td class="paramname">n</td><td>number of rows of V </td></tr>
    <tr><td class="paramname">m</td><td>number of columns of V </td></tr>
    <tr><td class="paramname">T</td><td>Toeplitz matrix data composed of the non-zero entries of his first row </td></tr>
    <tr><td class="paramname">T_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">blocksize</td><td>block size used in the sliding window algorithm </td></tr>
    <tr><td class="paramname">lambda</td><td>Toeplitz band width </td></tr>
    <tr><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramname">nfft</td><td>number of simultaneous FFTs </td></tr>
    <tr><td class="paramname">plan_f</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramname">plan_b</td><td>fftw plan backward (c2r) </td></tr>
    <tr><td class="paramname">flag_offset</td><td>flag to avoid extra 2*lambda padding to zeros on the edges </td></tr>
    <tr><td class="paramname">flag_nofft</td><td>flag to do product without using fft </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00661">661</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="gace7322011cd24b469e9b5d530e8a71ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gace7322011cd24b469e9b5d530e8a71ba">&#9670;&nbsp;</a></span>stmm_main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stmm_main </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>T_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFlag.html">Flag</a>&#160;</td>
          <td class="paramname"><em>flag_stgy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the product of a Toeplitz matrix by a general matrix using the sliding window algorithm with optimize reshaping. (an INTERNAL routine) </p>
<p>The input matrix is formatted into an optimized matrix depending on the block size and the number of simultaneous ffts (defined with the variable nfft). The obtained number of columns represent the number of vectors FFTs of which are computed simulatenously. The multiplication is then performed block-by-block with the chosen block size using the core routine. The parameters are : </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">V</td><td><b></b>[input] data matrix (with the convention V(i,j)=V[i+j*n]) ; <b></b>[out] result of the product TV </td></tr>
    <tr><td class="paramname">n</td><td>number of rows of V </td></tr>
    <tr><td class="paramname">m</td><td>number of columns of V </td></tr>
    <tr><td class="paramname">id0</td><td>first index of V </td></tr>
    <tr><td class="paramname">l</td><td>length of V </td></tr>
    <tr><td class="paramname">T</td><td>Toeplitz matrix data composed of the non-zero entries of his first row </td></tr>
    <tr><td class="paramname">T_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">lambda</td><td>Toeplitz band width </td></tr>
    <tr><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramname">plan_f</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramname">plan_b</td><td>fftw plan backward (c2r) </td></tr>
    <tr><td class="paramname">blocksize</td><td>block size </td></tr>
    <tr><td class="paramname">nfft</td><td>number of simultaneous FTTs </td></tr>
    <tr><td class="paramname">flag_stgy</td><td>flag strategy for the product computation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00805">805</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="gaf6b3f49e179ac9ed28354ddd7dbb6a04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf6b3f49e179ac9ed28354ddd7dbb6a04">&#9670;&nbsp;</a></span>build_gappy_blocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int build_gappy_blocks </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBlock.html">Block</a> *&#160;</td>
          <td class="paramname"><em>tpltzblocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_blocks_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_blocks_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t *&#160;</td>
          <td class="paramname"><em>id0gap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>lgap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBlock.html">Block</a> *&#160;</td>
          <td class="paramname"><em>tpltzblocks_gappy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nb_blocks_gappy_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_param_distmin_fixed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the gappy Toeplitz block structure to optimise the product computation at gaps location. </p>
<p>Considering the significant gaps, the blocks to which they belong are cut and split between the gap's edges to reduce the total row size of the flotting blocks. It take into consideration the minimum correlation length and a parameter that allows us to control the minimum gap size allowed to split the blocks. In some cases, the gap can be partially reduce to fit the minimum block size needed for computation or just for performance criteria. This is based on the fact that the gaps are previously set to zeros before calling this routine. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nrow</td><td>number of rows of the global data matrix V </td></tr>
    <tr><td class="paramname">m</td><td>number of columns for the data matrix V in the global rowwise order </td></tr>
    <tr><td class="paramname">tpltzblocks</td><td>list of the toeplitz blocks struture with its own parameters (idv, n, T_block, lambda). </td></tr>
    <tr><td class="paramname">nb_blocks_local</td><td>number of Toeplitz blocks as stored in T </td></tr>
    <tr><td class="paramname">nb_blocks_all</td><td>number of all Toeplitz block on the diagonal of the full Toeplitz matrix </td></tr>
    <tr><td class="paramname">id0gap</td><td>index of the first element of each defined gap </td></tr>
    <tr><td class="paramname">lgap</td><td>length of each defined gaps </td></tr>
    <tr><td class="paramname">ngap</td><td>number of defined gaps </td></tr>
    <tr><td class="paramname">tpltzblocks_gappy</td><td>list of the gappy toeplitz blocks struture with its own parameters </td></tr>
    <tr><td class="paramname">nb_blocks_gappy_final</td><td>real number of obtained gappy Toeplitz blocks </td></tr>
    <tr><td class="paramname">flag_param_distmin_fixed</td><td>flag to defined the minimum gap value allowed to split a Toeplitz block </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz__gappy_8c_source.html#l00231">231</a> of file <a class="el" href="toeplitz__gappy_8c_source.html">toeplitz_gappy.c</a>.</p>

</div>
</div>
<a id="gaf19f51ef406bebdb5e9400b6f9962077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf19f51ef406bebdb5e9400b6f9962077">&#9670;&nbsp;</a></span>stmm_simple_basic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stmm_simple_basic </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>TV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the product of a Toeplitz matrix by a matrix without using FFT's. </p>
<p>&lt;&gt; This routine multiplies the values directly between them. This exploit the fact that the bandwith is small compared to the matrix size. The number of operation is then no more than (lambda*2-1) multiplications and (lambda*2-1)-1 additions per row. </p>

<p class="definition">Definition at line <a class="el" href="toeplitz__nofft_8c_source.html#l00073">73</a> of file <a class="el" href="toeplitz__nofft_8c_source.html">toeplitz_nofft.c</a>.</p>

</div>
</div>
<a id="ga516de87d3daf22f1a29ba390d5e57caa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga516de87d3daf22f1a29ba390d5e57caa">&#9670;&nbsp;</a></span>stmm_simple_core()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stmm_simple_core </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. </p>
<p>The product is performed block-by-block with a defined block size or a computed optimized blocksize. This routine is not used by th API. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">V</td><td><b></b>[input] data matrix (with the convention V(i,j)=V[i+j*n]) ; <b></b>[out] result of the product TV </td></tr>
    <tr><td class="paramname">n</td><td>number of rows of V </td></tr>
    <tr><td class="paramname">m</td><td>number of columns of V </td></tr>
    <tr><td class="paramname">T</td><td>Toeplitz matrix data composed of the non-zero entries of his first row </td></tr>
    <tr><td class="paramname">blocksize</td><td>block size used in the sliding window algorithm </td></tr>
    <tr><td class="paramname">lambda</td><td>Toeplitz band width </td></tr>
    <tr><td class="paramname">nfft</td><td>number of simultaneous FFTs </td></tr>
    <tr><td class="paramname">flag_offset</td><td>flag to avoid extra 2*lambda padding to zeros on the edges </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz__nofft_8c_source.html#l00128">128</a> of file <a class="el" href="toeplitz__nofft_8c_source.html">toeplitz_nofft.c</a>.</p>

</div>
</div>
<a id="ga234bcc963a99bea09ed92b36c711c3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga234bcc963a99bea09ed92b36c711c3ec">&#9670;&nbsp;</a></span>flag_stgy_init_auto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flag_stgy_init_auto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFlag.html">Flag</a> *&#160;</td>
          <td class="paramname"><em>flag_stgy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the flag to automatic paramaters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flag_stgy</td><td>flag strategy for the product computation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz__params_8c_source.html#l00073">73</a> of file <a class="el" href="toeplitz__params_8c_source.html">toeplitz_params.c</a>.</p>

</div>
</div>
<a id="ga6de858af090da4b96df6a195015ce09e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6de858af090da4b96df6a195015ce09e">&#9670;&nbsp;</a></span>flag_stgy_init_zeros()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flag_stgy_init_zeros </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFlag.html">Flag</a> *&#160;</td>
          <td class="paramname"><em>flag_stgy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the flag parameters to zeros. This is almost the same as automatic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flag_stgy</td><td>flag strategy for the product computation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz__params_8c_source.html#l00091">91</a> of file <a class="el" href="toeplitz__params_8c_source.html">toeplitz_params.c</a>.</p>

</div>
</div>
<a id="gae334670891033aa91dd0bb7f8b707dc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae334670891033aa91dd0bb7f8b707dc4">&#9670;&nbsp;</a></span>flag_stgy_init_defined()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flag_stgy_init_defined </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFlag.html">Flag</a> *&#160;</td>
          <td class="paramname"><em>flag_stgy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the parameters flag to the defined ones. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flag_stgy</td><td>flag strategy for the product computation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz__params_8c_source.html#l00106">106</a> of file <a class="el" href="toeplitz__params_8c_source.html">toeplitz_params.c</a>.</p>

</div>
</div>
<a id="ga2d566ebeba6474d1bbac93315e1f578a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2d566ebeba6474d1bbac93315e1f578a">&#9670;&nbsp;</a></span>print_flag_stgy_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int print_flag_stgy_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFlag.html">Flag</a>&#160;</td>
          <td class="paramname"><em>flag_stgy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the flag parameters values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flag_stgy</td><td>flag strategy for the product computation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz__params_8c_source.html#l00131">131</a> of file <a class="el" href="toeplitz__params_8c_source.html">toeplitz_params.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri May 5 2023 22:24:03 for MIDAPACK - MIcrowave Data Analysis PACKage by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
