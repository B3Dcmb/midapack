<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MIDAPACK - MIcrowave Data Analysis PACKage: lower internal routines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoANR-MIDAS09_quarter.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MIDAPACK - MIcrowave Data Analysis PACKage
   &#160;<span id="projectnumber">1.1b</span>
   </div>
   <div id="projectbrief">Parallel software tools for high performance CMB DA analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__group22.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lower internal routines<div class="ingroups"><a class="el" href="group__toeplitz.html">TOEPLITZ module</a> &raquo; <a class="el" href="group__group2.html">internal routines</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga24331a8efb6e0b77df7c645ef45b2830"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group22.html#ga24331a8efb6e0b77df7c645ef45b2830">print_error_message</a> (int error_number, char const *file, int line)</td></tr>
<tr class="memdesc:ga24331a8efb6e0b77df7c645ef45b2830"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints error message corresponding to an error number.  <a href="group__group22.html#ga24331a8efb6e0b77df7c645ef45b2830">More...</a><br /></td></tr>
<tr class="separator:ga24331a8efb6e0b77df7c645ef45b2830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7dddc7df6f787d6aa92dfc25e9d0465a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group22.html#ga7dddc7df6f787d6aa92dfc25e9d0465a">copy_block</a> (int ninrow, int nincol, double *Vin, int noutrow, int noutcol, double *Vout, int inrow, int incol, int nblockrow, int nblockcol, int outrow, int outcol, double norm, int set_zero_flag)</td></tr>
<tr class="memdesc:ga7dddc7df6f787d6aa92dfc25e9d0465a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies (and potentially reshapes) a selected block of the input matrix to a specified position of the output matrix.  <a href="group__group22.html#ga7dddc7df6f787d6aa92dfc25e9d0465a">More...</a><br /></td></tr>
<tr class="separator:ga7dddc7df6f787d6aa92dfc25e9d0465a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7ea4ac654fcb9f5fe3bad139febb65d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group22.html#gaa7ea4ac654fcb9f5fe3bad139febb65d">mpi_stbmm</a> (double **V, int64_t nrow, int m, int m_rowwise, <a class="el" href="structBlock.html">Block</a> *tpltzblocks, int nb_blocks_local, int nb_blocks_all, int64_t idp, int local_V_size, <a class="el" href="structFlag.html">Flag</a> flag_stgy, MPI_Comm comm)</td></tr>
<tr class="memdesc:gaa7ea4ac654fcb9f5fe3bad139febb65d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the multiplication of a symmetric, Toeplitz block-diagonal matrix, T, by an arbitrary matrix, V, distributed over processes in the generalized column-wise way.  <a href="group__group22.html#gaa7ea4ac654fcb9f5fe3bad139febb65d">More...</a><br /></td></tr>
<tr class="separator:gaa7ea4ac654fcb9f5fe3bad139febb65d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c05d2ff1d358740d1c8965040e7080a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group22.html#ga8c05d2ff1d358740d1c8965040e7080a">gap_reduce</a> (double **V, int id0, int l, int lambda, int *id0gap, int *lgap, int ngap, int *newl, int id0out)</td></tr>
<tr class="memdesc:ga8c05d2ff1d358740d1c8965040e7080a"><td class="mdescLeft">&#160;</td><td class="mdescRight">...convert the data vector structure into a matrix structure optimized for nfft  <a href="group__group22.html#ga8c05d2ff1d358740d1c8965040e7080a">More...</a><br /></td></tr>
<tr class="separator:ga8c05d2ff1d358740d1c8965040e7080a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These are lower internal routines. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga24331a8efb6e0b77df7c645ef45b2830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga24331a8efb6e0b77df7c645ef45b2830">&#9670;&nbsp;</a></span>print_error_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int print_error_message </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>error_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints error message corresponding to an error number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">error_number</td><td>error number </td></tr>
    <tr><td class="paramname">file</td><td>file name </td></tr>
    <tr><td class="paramname">line</td><td>line number </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00093">93</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="ga7dddc7df6f787d6aa92dfc25e9d0465a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7dddc7df6f787d6aa92dfc25e9d0465a">&#9670;&nbsp;</a></span>copy_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int copy_block </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ninrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nincol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Vin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>noutrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>noutcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Vout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>inrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>incol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nblockrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nblockcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set_zero_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies (and potentially reshapes) a selected block of the input matrix to a specified position of the output matrix. </p>
<p>Copy a matrix block of a size nblockrow x nblockcol from the input matrix Vin (size ninrow x nincol) starting with the element (inrow, incol) to the output matrix Vout (size notrow x noutcol) starting with the element (outrow, outcol) after multiplying by norm. If the output matrix is larger than the block the extra elements are either left as they were on the input or zeroed if zero_flag is set to 1. If the block to be copied is larger than either the input or the output matrix an error occurs. </p>

<p class="definition">Definition at line <a class="el" href="toeplitz_8c_source.html#l00461">461</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a id="gaa7ea4ac654fcb9f5fe3bad139febb65d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa7ea4ac654fcb9f5fe3bad139febb65d">&#9670;&nbsp;</a></span>mpi_stbmm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mpi_stbmm </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>nrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m_rowwise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBlock.html">Block</a> *&#160;</td>
          <td class="paramname"><em>tpltzblocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_blocks_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_blocks_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>idp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>local_V_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structFlag.html">Flag</a>&#160;</td>
          <td class="paramname"><em>flag_stgy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the multiplication of a symmetric, Toeplitz block-diagonal matrix, T, by an arbitrary matrix, V, distributed over processes in the generalized column-wise way. </p>
<p>Each process performs the multiplication sequentially for each diagonal block and based on the sliding window algorithm. Prior to that MPI calls are used to exchange data between neighboring process. Each of the diagonal blocks is a symmetric, band-diagonal Toeplitz matrix, which can be different for each block. The parameters are : </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">V</td><td><b></b>[input] distributed data matrix (with the convention V(i,j)=V[i+j*n]) ; <b></b>[out] result of the product TV </td></tr>
    <tr><td class="paramname">nrow</td><td>number of rows of the global data matrix V </td></tr>
    <tr><td class="paramname">m</td><td>number of columns for the data matrix V in the global rowwise order </td></tr>
    <tr><td class="paramname">m_rowwise</td><td>number of columns for the data matrix V in the rowwise order per processor </td></tr>
    <tr><td class="paramname">tpltzblocks</td><td>list of the toeplitz blocks struture with its own parameters (idv, n, T_block, lambda) :<ul>
<li>idv is the global row index defining for each Toeplitz block as stored in the vector T ;</li>
<li>n size of each Toeplitz block</li>
<li>T_block location of each Toeplitz matrix data composed of the non-zero entries of the first row ;</li>
<li>lambda size of each Toeplitz block data T_block. The bandwith size is then equal to lambda*2-1 </li>
</ul>
</td></tr>
    <tr><td class="paramname">nb_blocks_all</td><td>number of all Toeplitz block on the diagonal of the full Toeplitz matrix </td></tr>
    <tr><td class="paramname">nb_blocks_local</td><td>number of Toeplitz blocks as stored in T </td></tr>
    <tr><td class="paramname">idp</td><td>global index of the first element of the local part of V </td></tr>
    <tr><td class="paramname">local_V_size</td><td>a number of all elements in local V </td></tr>
    <tr><td class="paramname">flag_stgy</td><td>flag strategy for the product computation </td></tr>
    <tr><td class="paramname">comm</td><td>MPI communicator </td></tr>
  </table>
  </dd>
</dl>
<p>[communication blocking example]</p>
<p>[communication blocking example]</p>
<p>[communication non-blocking example]</p>
<p>[communication non-blocking example]</p>
<p>[communication Wait example]</p>
<p>[communication Wait example]</p>
<p>Select the useful flotting blocks for the local data of the current processor. parameters (idpnew, local_V_size_new, nnew) for the computation. ide the local range are set with a size nnew equal to zero.</p>
<p>This compute the right parameters (idpnew, local_V_size_new, nnew) for the computation. All the block outside the local range are set with a size nnew equal to zero. local_V_size_new correspond to the size without the shift between the global rank index and the global index of the first flotting block. idnew is then set to the index of this first flotting block.</p>

<p class="definition">Definition at line <a class="el" href="toeplitz__block_8c_source.html#l00087">87</a> of file <a class="el" href="toeplitz__block_8c_source.html">toeplitz_block.c</a>.</p>

</div>
</div>
<a id="ga8c05d2ff1d358740d1c8965040e7080a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c05d2ff1d358740d1c8965040e7080a">&#9670;&nbsp;</a></span>gap_reduce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gap_reduce </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>id0gap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>lgap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>newl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id0out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>...convert the data vector structure into a matrix structure optimized for nfft </p>
<p>....Copy the data vector structure into an equivalent matrix with nfft column. Thus, the obtained matrix is optimize for the nfft multithreading algorithm use. The middle part is a direct copy of the data vector and we copy on the edges of each column the lambda terms needed to fullfill the correlation of theses data. </p>

<p class="definition">Definition at line <a class="el" href="toeplitz__gappy__seq_8dev_8c_source.html#l00163">163</a> of file <a class="el" href="toeplitz__gappy__seq_8dev_8c_source.html">toeplitz_gappy_seq.dev.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri May 5 2023 22:43:11 for MIDAPACK - MIcrowave Data Analysis PACKage by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
