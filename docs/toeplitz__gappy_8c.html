<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MIDAPACK - MIcrowave Data Analysis PACKage: toeplitz_gappy.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoANR-MIDAS09_quarter.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MIDAPACK - MIcrowave Data Analysis PACKage
   &#160;<span id="projectnumber">1.1b</span>
   </div>
   <div id="projectbrief">Parallel software tools for high performance CMB DA analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('toeplitz__gappy_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">toeplitz_gappy.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="toeplitz__gappy_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c3bdb98f0e937e6e84c8652e101acac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz__gappy_8c.html#a7c3bdb98f0e937e6e84c8652e101acac">mpi_gstbmm</a> (double **V, int nrow, int m, int m_rowwise, Block *tpltzblocks, int nb_blocks_local, int nb_blocks_all, int id0p, int local_V_size, int64_t *id0gap, int *lgap, int ngap, Flag flag_stgy, MPI_Comm comm)</td></tr>
<tr class="separator:a7c3bdb98f0e937e6e84c8652e101acac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e6b7aee01ebca970e271c4b4898bd73"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz__gappy_8c.html#a9e6b7aee01ebca970e271c4b4898bd73">reset_gaps</a> (double **V, int id0, int local_V_size, int m, int nrow, int m_rowwise, const int64_t *id0gap, const int *lgap, int ngap)</td></tr>
<tr class="memdesc:a9e6b7aee01ebca970e271c4b4898bd73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the data to zeros at the gaps location.  <a href="toeplitz__gappy_8c.html#a9e6b7aee01ebca970e271c4b4898bd73">More...</a><br /></td></tr>
<tr class="separator:a9e6b7aee01ebca970e271c4b4898bd73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa36eb742801e364bf05eeabfde83ff0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz__gappy_8c.html#aaa36eb742801e364bf05eeabfde83ff0">build_gappy_blocks</a> (int nrow, int m, Block *tpltzblocks, int nb_blocks_local, int nb_blocks_all, const int64_t *id0gap, const int *lgap, int ngap, Block *tpltzblocks_gappy, int *nb_blocks_gappy_final, int flag_param_distmin_fixed)</td></tr>
<tr class="separator:aaa36eb742801e364bf05eeabfde83ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7c3bdb98f0e937e6e84c8652e101acac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c3bdb98f0e937e6e84c8652e101acac">&#9670;&nbsp;</a></span>mpi_gstbmm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mpi_gstbmm </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m_rowwise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Block *&#160;</td>
          <td class="paramname"><em>tpltzblocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_blocks_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_blocks_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id0p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>local_V_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t *&#160;</td>
          <td class="paramname"><em>id0gap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>lgap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Flag&#160;</td>
          <td class="paramname"><em>flag_stgy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Performs the multiplication of a symmetric, Toeplitz block-diagonal matrix, T, by an arbitrary matrix, V, distributed over processes in the generalized column-wise way. This matrix V contains defined gaps which represents the useless data for the comutation. The gaps indexes are defined in the global time space as the generized toeplitz matrix, meaning the row dimension. Each of his diagonal blocks is a symmetric, band-diagonal Toeplitz matrix, which can be different for each block.</p>
<p>We first rebuild the Toeplitz block matrix structure to reduce the computation cost and skip the computations of the values on the defined gaps. then, each process performs the multiplication sequentially for each of the gappy block and based on the sliding window algorithm. Prior to that MPI calls are used to exchange data between neighboring process. The parameters are :</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">V</td><td><b></b>[input] distributed data matrix (with the convention V(i,j)=V[i+j*n]) ; <b></b>[out] result of the product TV</td></tr>
    <tr><td class="paramname">nrow</td><td>number of rows of the global data matrix V</td></tr>
    <tr><td class="paramname">m</td><td>number of columns for the data matrix V in the global rowwise order</td></tr>
    <tr><td class="paramname">m_rowwise</td><td>number of columns for the data matrix V in the rowwise order per processor</td></tr>
    <tr><td class="paramname">tpltzblocks</td><td>list of the toeplitz blocks struture with its own parameters (idv, n, T_block, lambda) :<ul>
<li>idv is the global row index defining for each Toeplitz block as stored in the vector T ;</li>
<li>n size of each Toeplitz block</li>
<li>T_block location of each Toeplitz matrix data composed of the non-zero entries of the first row ;</li>
<li>lambda size of each Toeplitz block data T_block. The bandwith size is then equal to lambda*2-1</li>
</ul>
</td></tr>
    <tr><td class="paramname">nb_blocks_all</td><td>number of all Toeplitz block on the diagonal of the full Toeplitz matrix</td></tr>
    <tr><td class="paramname">nb_blocks_local</td><td>number of Toeplitz blocks as stored in T</td></tr>
    <tr><td class="paramname">idp</td><td>global index of the first element of the local part of V</td></tr>
    <tr><td class="paramname">local_V_size</td><td>a number of all elements in local V</td></tr>
    <tr><td class="paramname">id0gap</td><td>index of the first element of each defined gap</td></tr>
    <tr><td class="paramname">lgap</td><td>length of each defined gaps</td></tr>
    <tr><td class="paramname">ngap</td><td>number of defined gaps</td></tr>
    <tr><td class="paramname">flag_stgy</td><td>flag strategy for the product computation</td></tr>
    <tr><td class="paramname">comm</td><td>MPI communicator </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz__gappy_8c_source.html#l00119">119</a> of file <a class="el" href="toeplitz__gappy_8c_source.html">toeplitz_gappy.c</a>.</p>

</div>
</div>
<a id="a9e6b7aee01ebca970e271c4b4898bd73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e6b7aee01ebca970e271c4b4898bd73">&#9670;&nbsp;</a></span>reset_gaps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int reset_gaps </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>local_V_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m_rowwise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t *&#160;</td>
          <td class="paramname"><em>id0gap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>lgap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the data to zeros at the gaps location. </p>
<p>The datas located on a gap are set to zeros. The gaps are defined in the time space, meaning their indexes are defined in the row dimension. </p>

<p class="definition">Definition at line <a class="el" href="toeplitz__gappy_8c_source.html#l00227">227</a> of file <a class="el" href="toeplitz__gappy_8c_source.html">toeplitz_gappy.c</a>.</p>

</div>
</div>
<a id="aaa36eb742801e364bf05eeabfde83ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa36eb742801e364bf05eeabfde83ff0">&#9670;&nbsp;</a></span>build_gappy_blocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int build_gappy_blocks </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Block *&#160;</td>
          <td class="paramname"><em>tpltzblocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_blocks_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_blocks_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t *&#160;</td>
          <td class="paramname"><em>id0gap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>lgap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ngap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Block *&#160;</td>
          <td class="paramname"><em>tpltzblocks_gappy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nb_blocks_gappy_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_param_distmin_fixed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build the gappy Toeplitz block structure to optimise the product computation at gaps location.</p>
<p>Considering the significant gaps, the blocks to which they belong are cut and split between the gap's edges to reduce the total row size of the flotting blocks. It take into consideration the minimum correlation length and a parameter that allows us to control the minimum gap size allowed to split the blocks. In some cases, the gap can be partially reduce to fit the minimum block size needed for computation or just for performance criteria. This is based on the fact that the gaps are previously set to zeros before calling this routine.</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nrow</td><td>number of rows of the global data matrix V </td></tr>
    <tr><td class="paramname">m</td><td>number of columns for the data matrix V in the global rowwise order </td></tr>
    <tr><td class="paramname">tpltzblocks</td><td>list of the toeplitz blocks struture with its own parameters (idv, n, T_block, lambda).</td></tr>
    <tr><td class="paramname">nb_blocks_local</td><td>number of Toeplitz blocks as stored in T</td></tr>
    <tr><td class="paramname">nb_blocks_all</td><td>number of all Toeplitz block on the diagonal of the full Toeplitz matrix</td></tr>
    <tr><td class="paramname">id0gap</td><td>index of the first element of each defined gap</td></tr>
    <tr><td class="paramname">lgap</td><td>length of each defined gaps </td></tr>
    <tr><td class="paramname">ngap</td><td>number of defined gaps </td></tr>
    <tr><td class="paramname">tpltzblocks_gappy</td><td>list of the gappy toeplitz blocks struture with its own parameters</td></tr>
    <tr><td class="paramname">nb_blocks_gappy_final</td><td>real number of obtained gappy Toeplitz blocks</td></tr>
    <tr><td class="paramname">flag_param_distmin_fixed</td><td>flag to defined the minimum gap value allowed to split a Toeplitz block </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="toeplitz__gappy_8c_source.html#l00274">274</a> of file <a class="el" href="toeplitz__gappy_8c_source.html">toeplitz_gappy.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e53b58e09df6ccf29305fb05aac16e30.html">algebra</a></li><li class="navelem"><a class="el" href="dir_50322682acf1ecaee1cadf941110c2e1.html">src</a></li><li class="navelem"><a class="el" href="dir_ab9ac125a1af3c89f2feea55313317c2.html">toeplitz</a></li><li class="navelem"><a class="el" href="toeplitz__gappy_8c.html">toeplitz_gappy.c</a></li>
    <li class="footer">Generated on Mon Jul 29 2024 16:33:04 for MIDAPACK - MIcrowave Data Analysis PACKage by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
