\hypertarget{group__group11}{\section{multithreaded/sequential routines}
\label{group__group11}\index{multithreaded/sequential routines@{multithreaded/sequential routines}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__group11_ga7f4e77d71f2c6f2caf652bab7520e3f4}{tpltz\-\_\-init} (int n, int lambda, int $\ast$nfft, int $\ast$blocksize, fftw\-\_\-complex $\ast$$\ast$T\-\_\-fft, double $\ast$T, fftw\-\_\-complex $\ast$$\ast$V\-\_\-fft, double $\ast$$\ast$V\-\_\-rfft, fftw\-\_\-plan $\ast$plan\-\_\-f, fftw\-\_\-plan $\ast$plan\-\_\-b, \hyperlink{structFlag}{Flag} flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Sets a block size and initializes all fftw arrays and plans needed for the computation. \end{DoxyCompactList}\item 
int \hyperlink{group__group11_gac7ac0ee5f6eaee6846814b131671f6e8}{tpltz\-\_\-cleanup} (fftw\-\_\-complex $\ast$$\ast$T\-\_\-fft, fftw\-\_\-complex $\ast$$\ast$V\-\_\-fft, double $\ast$$\ast$V\-\_\-rfft, fftw\-\_\-plan $\ast$plan\-\_\-f, fftw\-\_\-plan $\ast$plan\-\_\-b)
\begin{DoxyCompactList}\small\item\em Cleans fftw workspace used in the Toeplitz matrix matrix product's computation. \end{DoxyCompactList}\item 
int \hyperlink{group__group11_ga639be254160aa6fdb502dfff6190950a}{reset\-\_\-gaps} (double $\ast$$\ast$V, int id0, int local\-\_\-\-V\-\_\-size, int m, int nrow, int m\-\_\-rowwise, int64\-\_\-t $\ast$id0gap, int $\ast$lgap, int ngap)
\begin{DoxyCompactList}\small\item\em Set the data to zeros at the gaps location. \end{DoxyCompactList}\item 
int \hyperlink{group__group11_ga8a16933581102fbad56d8ef6610eac81}{gap\-\_\-masking} (double $\ast$$\ast$V, int l, int $\ast$id0gap, int $\ast$lgap, int ngap)
\begin{DoxyCompactList}\small\item\em Reduce the vector and mask the defined gaps. \end{DoxyCompactList}\item 
int \hyperlink{group__group11_gaf84a476c33acadd1dbfa6e9833e16499}{gap\-\_\-filling} (double $\ast$$\ast$V, int l, int $\ast$id0gap, int $\ast$lgap, int ngap)
\begin{DoxyCompactList}\small\item\em Extend the vector and add zeros on the gaps locations. \end{DoxyCompactList}\item 
int \hyperlink{group__group11_gab2face64bf4e429b38b3ae1a6701cc78}{stmm} (double $\ast$$\ast$V, int n, int m, double $\ast$T, int lambda, \hyperlink{structFlag}{Flag} flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Perform the product of a Toeplitz matrix by a general matrix using the sliding window algorithm. \end{DoxyCompactList}\item 
int \hyperlink{group__group11_ga4cd10fd194db5a77c0366cddeda596ae}{gstbmm} (double $\ast$$\ast$V, int nrow, int m\-\_\-cw, int m\-\_\-rw, \hyperlink{structBlock}{Block} $\ast$tpltzblocks, int nb\-\_\-blocks, int64\-\_\-t idp, int local\-\_\-\-V\-\_\-size, int64\-\_\-t $\ast$id0gap, int $\ast$lgap, int ngap, \hyperlink{structFlag}{Flag} flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Performs the multiplication of a symmetric, Toeplitz block-\/diagonal matrix with gaps, T, by an arbitrary matrix, V, distributed over processes. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
These are shared-\/memory routines. 

\subsection{Function Documentation}
\hypertarget{group__group11_ga7f4e77d71f2c6f2caf652bab7520e3f4}{\index{multithreaded/sequential routines@{multithreaded/sequential routines}!tpltz\-\_\-init@{tpltz\-\_\-init}}
\index{tpltz\-\_\-init@{tpltz\-\_\-init}!multithreaded/sequential routines@{multithreaded/sequential routines}}
\subsubsection[{tpltz\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int tpltz\-\_\-init (
\begin{DoxyParamCaption}
\item[{int}]{n, }
\item[{int}]{lambda, }
\item[{int $\ast$}]{nfft, }
\item[{int $\ast$}]{blocksize, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{T\-\_\-fft, }
\item[{double $\ast$}]{T, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{V\-\_\-fft, }
\item[{double $\ast$$\ast$}]{V\-\_\-rfft, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-b, }
\item[{{\bf Flag}}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}}\label{group__group11_ga7f4e77d71f2c6f2caf652bab7520e3f4}


Sets a block size and initializes all fftw arrays and plans needed for the computation. 

Initializes the fftw arrays and plans is necessary before any computation of the Toeplitz matrix matrix product. Use tpltz\-\_\-cleanup afterwards. \begin{DoxySeeAlso}{See also}
\hyperlink{group__group11_gac7ac0ee5f6eaee6846814b131671f6e8}{tpltz\-\_\-cleanup} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em n} & row size of the matrix used for later product \\
\hline
{\em lambda} & Toeplitz band width \\
\hline
{\em nfft} & maximum number of F\-F\-Ts you want to compute at the same time \\
\hline
{\em blocksize} & optimal block size used in the sliding window algorithm to compute an optimize value) \\
\hline
{\em T\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em T} & Toeplitz matrix \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00257}{257} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group11_gac7ac0ee5f6eaee6846814b131671f6e8}{\index{multithreaded/sequential routines@{multithreaded/sequential routines}!tpltz\-\_\-cleanup@{tpltz\-\_\-cleanup}}
\index{tpltz\-\_\-cleanup@{tpltz\-\_\-cleanup}!multithreaded/sequential routines@{multithreaded/sequential routines}}
\subsubsection[{tpltz\-\_\-cleanup}]{\setlength{\rightskip}{0pt plus 5cm}int tpltz\-\_\-cleanup (
\begin{DoxyParamCaption}
\item[{fftw\-\_\-complex $\ast$$\ast$}]{T\-\_\-fft, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{V\-\_\-fft, }
\item[{double $\ast$$\ast$}]{V\-\_\-rfft, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-b}
\end{DoxyParamCaption}
)}}\label{group__group11_gac7ac0ee5f6eaee6846814b131671f6e8}


Cleans fftw workspace used in the Toeplitz matrix matrix product's computation. 

Destroy fftw plans, free memory and reset fftw workspace. \begin{DoxySeeAlso}{See also}
\hyperlink{toeplitz__gappy__seq_8dev_8h_a3fac4cc3f8d7258404fa2e7ab43137e7}{tpltz\-\_\-init} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em T\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00435}{435} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group11_ga639be254160aa6fdb502dfff6190950a}{\index{multithreaded/sequential routines@{multithreaded/sequential routines}!reset\-\_\-gaps@{reset\-\_\-gaps}}
\index{reset\-\_\-gaps@{reset\-\_\-gaps}!multithreaded/sequential routines@{multithreaded/sequential routines}}
\subsubsection[{reset\-\_\-gaps}]{\setlength{\rightskip}{0pt plus 5cm}int reset\-\_\-gaps (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{id0, }
\item[{int}]{local\-\_\-\-V\-\_\-size, }
\item[{int}]{m, }
\item[{int}]{nrow, }
\item[{int}]{m\-\_\-rowwise, }
\item[{int64\-\_\-t $\ast$}]{id0gap, }
\item[{int $\ast$}]{lgap, }
\item[{int}]{ngap}
\end{DoxyParamCaption}
)}}\label{group__group11_ga639be254160aa6fdb502dfff6190950a}


Set the data to zeros at the gaps location. 

The datas located on a gap are set to zeros. The gaps are defined in the time space, meaning their indexes are defined in the row dimension. 

Definition at line \hyperlink{toeplitz__gappy_8c_source_l00189}{189} of file \hyperlink{toeplitz__gappy_8c_source}{toeplitz\-\_\-gappy.\-c}.

\hypertarget{group__group11_ga8a16933581102fbad56d8ef6610eac81}{\index{multithreaded/sequential routines@{multithreaded/sequential routines}!gap\-\_\-masking@{gap\-\_\-masking}}
\index{gap\-\_\-masking@{gap\-\_\-masking}!multithreaded/sequential routines@{multithreaded/sequential routines}}
\subsubsection[{gap\-\_\-masking}]{\setlength{\rightskip}{0pt plus 5cm}int gap\-\_\-masking (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{l, }
\item[{int $\ast$}]{id0gap, }
\item[{int $\ast$}]{lgap, }
\item[{int}]{ngap}
\end{DoxyParamCaption}
)}}\label{group__group11_ga8a16933581102fbad56d8ef6610eac81}


Reduce the vector and mask the defined gaps. 


\begin{DoxyParams}{Parameters}
{\em V} & input/output vector \\
\hline
{\em l} & length of the vector \\
\hline
{\em id0gap} & gap first index \\
\hline
{\em lgap} & gap length \\
\hline
{\em ngap} & number of gaps \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__gappy__seq_8dev_8c_source_l00255}{255} of file \hyperlink{toeplitz__gappy__seq_8dev_8c_source}{toeplitz\-\_\-gappy\-\_\-seq.\-dev.\-c}.

\hypertarget{group__group11_gaf84a476c33acadd1dbfa6e9833e16499}{\index{multithreaded/sequential routines@{multithreaded/sequential routines}!gap\-\_\-filling@{gap\-\_\-filling}}
\index{gap\-\_\-filling@{gap\-\_\-filling}!multithreaded/sequential routines@{multithreaded/sequential routines}}
\subsubsection[{gap\-\_\-filling}]{\setlength{\rightskip}{0pt plus 5cm}int gap\-\_\-filling (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{l, }
\item[{int $\ast$}]{id0gap, }
\item[{int $\ast$}]{lgap, }
\item[{int}]{ngap}
\end{DoxyParamCaption}
)}}\label{group__group11_gaf84a476c33acadd1dbfa6e9833e16499}


Extend the vector and add zeros on the gaps locations. 


\begin{DoxyParams}{Parameters}
{\em V} & input/output vector \\
\hline
{\em l} & length of the extend vector \\
\hline
{\em id0gap} & gap first index \\
\hline
{\em lgap} & gap length \\
\hline
{\em ngap} & number of gaps \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__gappy__seq_8dev_8c_source_l00293}{293} of file \hyperlink{toeplitz__gappy__seq_8dev_8c_source}{toeplitz\-\_\-gappy\-\_\-seq.\-dev.\-c}.

\hypertarget{group__group11_gab2face64bf4e429b38b3ae1a6701cc78}{\index{multithreaded/sequential routines@{multithreaded/sequential routines}!stmm@{stmm}}
\index{stmm@{stmm}!multithreaded/sequential routines@{multithreaded/sequential routines}}
\subsubsection[{stmm}]{\setlength{\rightskip}{0pt plus 5cm}int stmm (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{n, }
\item[{int}]{m, }
\item[{double $\ast$}]{T, }
\item[{int}]{lambda, }
\item[{{\bf Flag}}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}}\label{group__group11_gab2face64bf4e429b38b3ae1a6701cc78}


Perform the product of a Toeplitz matrix by a general matrix using the sliding window algorithm. 

This is a simplifed call of the sequential product including initialization and cleaning. This use the flag parameters to set the comutational options. 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em n} & number of rows of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em T} & Toeplitz matrix data composed of the non-\/zero entries of his first row \\
\hline
{\em lambda} & number of non-\/zero in the first row of the Toeplitz and size of T \\
\hline
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__seq_8c_source_l00072}{72} of file \hyperlink{toeplitz__seq_8c_source}{toeplitz\-\_\-seq.\-c}.

\hypertarget{group__group11_ga4cd10fd194db5a77c0366cddeda596ae}{\index{multithreaded/sequential routines@{multithreaded/sequential routines}!gstbmm@{gstbmm}}
\index{gstbmm@{gstbmm}!multithreaded/sequential routines@{multithreaded/sequential routines}}
\subsubsection[{gstbmm}]{\setlength{\rightskip}{0pt plus 5cm}int gstbmm (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{nrow, }
\item[{int}]{m\-\_\-cw, }
\item[{int}]{m\-\_\-rw, }
\item[{{\bf Block} $\ast$}]{tpltzblocks, }
\item[{int}]{nb\-\_\-blocks, }
\item[{int64\-\_\-t}]{idp, }
\item[{int}]{local\-\_\-\-V\-\_\-size, }
\item[{int64\-\_\-t $\ast$}]{id0gap, }
\item[{int $\ast$}]{lgap, }
\item[{int}]{ngap, }
\item[{{\bf Flag}}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}}\label{group__group11_ga4cd10fd194db5a77c0366cddeda596ae}


Performs the multiplication of a symmetric, Toeplitz block-\/diagonal matrix with gaps, T, by an arbitrary matrix, V, distributed over processes. 

We first rebuild the Toeplitz block matrix structure to reduce the computation cost and skip the computations of the values on the defined gaps.

The parameters are \-: 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} distributed data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em nrow} & number of rows of the global data matrix V \\
\hline
{\em m} & number of columns for the data matrix V in the global rowwise order \\
\hline
{\em m\-\_\-rowwise} & number of columns for the data matrix V in the rowwise order per processor \\
\hline
{\em tpltzblocks} & list of the toeplitz blocks struture with its own parameters (idv, n, T\-\_\-block, lambda) \-:
\begin{DoxyItemize}
\item idv is the global row index defining for each Toeplitz block as stored in the vector T ;
\item n size of each Toeplitz block
\item T\-\_\-block location of each Toeplitz matrix data composed of the non-\/zero entries of the first row ;
\item lambda size of each Toeplitz block data T\-\_\-block. The bandwith size is then equal to lambda$\ast$2-\/1 
\end{DoxyItemize}\\
\hline
{\em nb\-\_\-blocks\-\_\-all} & number of all Toeplitz block on the diagonal of the full Toeplitz matrix \\
\hline
{\em nb\-\_\-blocks\-\_\-local} & number of Toeplitz blocks as stored in T \\
\hline
{\em idp} & global index of the first element of the local part of V \\
\hline
{\em local\-\_\-\-V\-\_\-size} & a number of all elements in local V \\
\hline
{\em id0gap} & index of the first element of each defined gap \\
\hline
{\em lgap} & length of each defined gaps \\
\hline
{\em ngap} & number of defined gaps \\
\hline
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__seq_8c_source_l00170}{170} of file \hyperlink{toeplitz__seq_8c_source}{toeplitz\-\_\-seq.\-c}.

