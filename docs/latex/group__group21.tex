\hypertarget{group__group21}{\section{low-\/level routines}
\label{group__group21}\index{low-\/level routines@{low-\/level routines}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__group21_ga186fc8d8825da293e94de77b77d01fba}{define\-\_\-blocksize} (int n, int lambda, int bs\-\_\-flag, int fixed\-\_\-bs)
\begin{DoxyCompactList}\small\item\em Defines an optimal size of the block used in the sliding windows algorithm. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga4c2846ca9f67faae5746325d1ec63aac}{define\-\_\-nfft} (int n\-\_\-thread, int flag\-\_\-nfft, int fixed\-\_\-nfft)
\begin{DoxyCompactList}\small\item\em Defines the number of simultaneous ffts for the Toeplitz matrix product computation. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_gae3d694bcffacaf24706f0586a223538e}{fftw\-\_\-init\-\_\-omp\-\_\-threads} (int fftw\-\_\-n\-\_\-thread)
\begin{DoxyCompactList}\small\item\em Initialize omp threads for fftw plans. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga1a6106fbaa68aab85595935252299097}{rhs\-\_\-init\-\_\-fftw} (int $\ast$nfft, int fft\-\_\-size, fftw\-\_\-complex $\ast$$\ast$V\-\_\-fft, double $\ast$$\ast$V\-\_\-rfft, fftw\-\_\-plan $\ast$plan\-\_\-f, fftw\-\_\-plan $\ast$plan\-\_\-b, int fftw\-\_\-flag)
\begin{DoxyCompactList}\small\item\em Initializes fftw array and plan for the right hand side, general matrix V. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga6c68921dafc6dc184d335a59df68e5f7}{circ\-\_\-init\-\_\-fftw} (double $\ast$T, int fft\-\_\-size, int lambda, fftw\-\_\-complex $\ast$$\ast$T\-\_\-fft)
\begin{DoxyCompactList}\small\item\em Initializes fftw array and plan for the circulant matrix T\-\_\-circ obtained from T. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga2c399885221722e98f72206ddce8d0d3}{scmm\-\_\-direct} (int fft\-\_\-size, int nfft, fftw\-\_\-complex $\ast$C\-\_\-fft, int ncol, double $\ast$V\-\_\-rfft, double $\ast$$\ast$C\-V, fftw\-\_\-complex $\ast$V\-\_\-fft, fftw\-\_\-plan plan\-\_\-f\-\_\-\-V, fftw\-\_\-plan plan\-\_\-b\-\_\-\-C\-V)
\begin{DoxyCompactList}\small\item\em Performs the product of a circulant matrix C\-\_\-fft by a matrix V\-\_\-rfft using fftw plans. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_gab8839f416f8f8165b31a5363c405428d}{scmm\-\_\-basic} (double $\ast$$\ast$V, int blocksize, int m, fftw\-\_\-complex $\ast$C\-\_\-fft, double $\ast$$\ast$C\-V, fftw\-\_\-complex $\ast$V\-\_\-fft, double $\ast$V\-\_\-rfft, int nfft, fftw\-\_\-plan plan\-\_\-f\-\_\-\-V, fftw\-\_\-plan plan\-\_\-b\-\_\-\-C\-V)
\begin{DoxyCompactList}\small\item\em Performs the product of a circulant matrix by a matrix using F\-F\-T's (an I\-N\-T\-E\-R\-N\-A\-L routine) \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga2731f1bbfce2d47c4cc3381150470da4}{stmm\-\_\-core} (double $\ast$$\ast$V, int n, int m, double $\ast$T, fftw\-\_\-complex $\ast$T\-\_\-fft, int blocksize, int lambda, fftw\-\_\-complex $\ast$V\-\_\-fft, double $\ast$V\-\_\-rfft, int nfft, fftw\-\_\-plan plan\-\_\-f, fftw\-\_\-plan plan\-\_\-b, int flag\-\_\-offset, int flag\-\_\-nofft)
\begin{DoxyCompactList}\small\item\em Performs the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. (an I\-N\-T\-E\-R\-N\-A\-L routine) \end{DoxyCompactList}\item 
int \hyperlink{group__group21_gace7322011cd24b469e9b5d530e8a71ba}{stmm\-\_\-main} (double $\ast$$\ast$V, int n, int m, int id0, int l, double $\ast$T, fftw\-\_\-complex $\ast$T\-\_\-fft, int lambda, fftw\-\_\-complex $\ast$V\-\_\-fft, double $\ast$V\-\_\-rfft, fftw\-\_\-plan plan\-\_\-f, fftw\-\_\-plan plan\-\_\-b, int blocksize, int nfft, \hyperlink{structFlag}{Flag} flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Performs the product of a Toeplitz matrix by a general matrix using the sliding window algorithm with optimize reshaping. (an I\-N\-T\-E\-R\-N\-A\-L routine) \end{DoxyCompactList}\item 
int \hyperlink{group__group21_gaf6b3f49e179ac9ed28354ddd7dbb6a04}{build\-\_\-gappy\-\_\-blocks} (int nrow, int m, \hyperlink{structBlock}{Block} $\ast$tpltzblocks, int nb\-\_\-blocks\-\_\-local, int nb\-\_\-blocks\-\_\-all, int64\-\_\-t $\ast$id0gap, int $\ast$lgap, int ngap, \hyperlink{structBlock}{Block} $\ast$tpltzblocks\-\_\-gappy, int $\ast$nb\-\_\-blocks\-\_\-gappy\-\_\-final, int flag\-\_\-param\-\_\-distmin\-\_\-fixed)
\begin{DoxyCompactList}\small\item\em Build the gappy Toeplitz block structure to optimise the product computation at gaps location. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_gaf19f51ef406bebdb5e9400b6f9962077}{stmm\-\_\-simple\-\_\-basic} (double $\ast$$\ast$V, int n, int m, double $\ast$T, int lambda, double $\ast$$\ast$T\-V)
\begin{DoxyCompactList}\small\item\em Perform the product of a Toeplitz matrix by a matrix without using F\-F\-T's. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga516de87d3daf22f1a29ba390d5e57caa}{stmm\-\_\-simple\-\_\-core} (double $\ast$$\ast$V, int n, int m, double $\ast$T, int blocksize, int lambda, int nfft, int flag\-\_\-offset)
\begin{DoxyCompactList}\small\item\em Perform the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga234bcc963a99bea09ed92b36c711c3ec}{flag\-\_\-stgy\-\_\-init\-\_\-auto} (\hyperlink{structFlag}{Flag} $\ast$flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Set the flag to automatic paramaters. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga6de858af090da4b96df6a195015ce09e}{flag\-\_\-stgy\-\_\-init\-\_\-zeros} (\hyperlink{structFlag}{Flag} $\ast$flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Set the flag parameters to zeros. This is almost the same as automatic. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_gae334670891033aa91dd0bb7f8b707dc4}{flag\-\_\-stgy\-\_\-init\-\_\-defined} (\hyperlink{structFlag}{Flag} $\ast$flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Set the parameters flag to the defined ones. \end{DoxyCompactList}\item 
int \hyperlink{group__group21_ga2d566ebeba6474d1bbac93315e1f578a}{print\-\_\-flag\-\_\-stgy\-\_\-init} (\hyperlink{structFlag}{Flag} flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Print the flag parameters values. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
These are low-\/level routines. 

\subsection{Function Documentation}
\hypertarget{group__group21_ga186fc8d8825da293e94de77b77d01fba}{\index{low-\/level routines@{low-\/level routines}!define\-\_\-blocksize@{define\-\_\-blocksize}}
\index{define\-\_\-blocksize@{define\-\_\-blocksize}!low-level routines@{low-\/level routines}}
\subsubsection[{define\-\_\-blocksize}]{\setlength{\rightskip}{0pt plus 5cm}int define\-\_\-blocksize (
\begin{DoxyParamCaption}
\item[{int}]{n, }
\item[{int}]{lambda, }
\item[{int}]{bs\-\_\-flag, }
\item[{int}]{fixed\-\_\-bs}
\end{DoxyParamCaption}
)}}\label{group__group21_ga186fc8d8825da293e94de77b77d01fba}


Defines an optimal size of the block used in the sliding windows algorithm. 

The optimal block size is computed as the minimum power of two above 3$\ast$lambda, i.\-e. the smallest value equal to 2$^\wedge$x, where x is an integer, and above 3$\ast$lambda. If bs\-\_\-flag is set to one, a different formula is used to compute the optimal block size (see M\-A\-Dmap\-: A M\-A\-S\-S\-I\-V\-E\-L\-Y P\-A\-R\-A\-L\-L\-E\-L M\-A\-X\-I\-M\-U\-M L\-I\-K\-E\-L\-I\-H\-O\-O\-D C\-O\-S\-M\-I\-C M\-I\-C\-R\-O\-W\-A\-V\-E B\-A\-C\-K\-G\-R\-O\-U\-N\-D M\-A\-P-\/\-M\-A\-K\-E\-R, C. M. Cantalupo, J. D. Borrill, A. H. Jaffe, T. S. Kisner, and R. Stompor, The Astrophysical Journal Supplement Series, 187\-:212â€“227, 2010 March). To avoid using block size much bigger than the matrix, the block size is set to 3$\ast$lambda when his previous computed size is bigger than the matrix size n. This case append mostly for small matrix compared to his bandwith. 
\begin{DoxyParams}{Parameters}
{\em n} & matrix row dimension \\
\hline
{\em lambda} & half bandwidth of the Toeplitz matrix \\
\hline
{\em bs\-\_\-flag} & flag to use a different formula for optimal block size computation \\
\hline
{\em fixed\-\_\-bs} & fixed blocksize value if needed \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00130}{130} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_ga4c2846ca9f67faae5746325d1ec63aac}{\index{low-\/level routines@{low-\/level routines}!define\-\_\-nfft@{define\-\_\-nfft}}
\index{define\-\_\-nfft@{define\-\_\-nfft}!low-level routines@{low-\/level routines}}
\subsubsection[{define\-\_\-nfft}]{\setlength{\rightskip}{0pt plus 5cm}int define\-\_\-nfft (
\begin{DoxyParamCaption}
\item[{int}]{n\-\_\-thread, }
\item[{int}]{flag\-\_\-nfft, }
\item[{int}]{fixed\-\_\-nfft}
\end{DoxyParamCaption}
)}}\label{group__group21_ga4c2846ca9f67faae5746325d1ec63aac}


Defines the number of simultaneous ffts for the Toeplitz matrix product computation. 


\begin{DoxyParams}{Parameters}
{\em n\-\_\-thread} & number of omp threads \\
\hline
{\em flag\-\_\-nfft} & flag to set the strategy to define nfft \\
\hline
{\em fixed\-\_\-nfft} & fixed nfft value if nedeed (used for the case where flag\-\_\-nfft=1) \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00220}{220} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_gae3d694bcffacaf24706f0586a223538e}{\index{low-\/level routines@{low-\/level routines}!fftw\-\_\-init\-\_\-omp\-\_\-threads@{fftw\-\_\-init\-\_\-omp\-\_\-threads}}
\index{fftw\-\_\-init\-\_\-omp\-\_\-threads@{fftw\-\_\-init\-\_\-omp\-\_\-threads}!low-level routines@{low-\/level routines}}
\subsubsection[{fftw\-\_\-init\-\_\-omp\-\_\-threads}]{\setlength{\rightskip}{0pt plus 5cm}int fftw\-\_\-init\-\_\-omp\-\_\-threads (
\begin{DoxyParamCaption}
\item[{int}]{fftw\-\_\-n\-\_\-thread}
\end{DoxyParamCaption}
)}}\label{group__group21_gae3d694bcffacaf24706f0586a223538e}


Initialize omp threads for fftw plans. 

Initialize omp threads for fftw plans. The number of threads used for ffts (define by the variable n\-\_\-thread) is read from O\-M\-P\-\_\-\-N\-U\-M\-\_\-\-T\-H\-R\-E\-A\-D environment variable. fftw multithreaded option is controlled by fftw\-\_\-\-M\-U\-L\-T\-I\-T\-H\-R\-E\-A\-D\-I\-N\-G macro. 

Definition at line \hyperlink{toeplitz_8c_source_l00333}{333} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_ga1a6106fbaa68aab85595935252299097}{\index{low-\/level routines@{low-\/level routines}!rhs\-\_\-init\-\_\-fftw@{rhs\-\_\-init\-\_\-fftw}}
\index{rhs\-\_\-init\-\_\-fftw@{rhs\-\_\-init\-\_\-fftw}!low-level routines@{low-\/level routines}}
\subsubsection[{rhs\-\_\-init\-\_\-fftw}]{\setlength{\rightskip}{0pt plus 5cm}int rhs\-\_\-init\-\_\-fftw (
\begin{DoxyParamCaption}
\item[{int $\ast$}]{nfft, }
\item[{int}]{fft\-\_\-size, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{V\-\_\-fft, }
\item[{double $\ast$$\ast$}]{V\-\_\-rfft, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-b, }
\item[{int}]{fftw\-\_\-flag}
\end{DoxyParamCaption}
)}}\label{group__group21_ga1a6106fbaa68aab85595935252299097}


Initializes fftw array and plan for the right hand side, general matrix V. 

Initialize fftw array and plan for the right hand side matrix V. 
\begin{DoxyParams}{Parameters}
{\em nfft} & maximum number of F\-F\-Ts you want to compute at the same time \\
\hline
{\em fft\-\_\-size} & effective F\-F\-T size for the general matrix V (usually equal to blocksize) \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
{\em fftw\-\_\-flag} & fftw plan allocation flag \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00365}{365} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_ga6c68921dafc6dc184d335a59df68e5f7}{\index{low-\/level routines@{low-\/level routines}!circ\-\_\-init\-\_\-fftw@{circ\-\_\-init\-\_\-fftw}}
\index{circ\-\_\-init\-\_\-fftw@{circ\-\_\-init\-\_\-fftw}!low-level routines@{low-\/level routines}}
\subsubsection[{circ\-\_\-init\-\_\-fftw}]{\setlength{\rightskip}{0pt plus 5cm}int circ\-\_\-init\-\_\-fftw (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{T, }
\item[{int}]{fft\-\_\-size, }
\item[{int}]{lambda, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{T\-\_\-fft}
\end{DoxyParamCaption}
)}}\label{group__group21_ga6c68921dafc6dc184d335a59df68e5f7}


Initializes fftw array and plan for the circulant matrix T\-\_\-circ obtained from T. 

Builds the circulant matrix T\-\_\-circ from T and initilizes its fftw arrays and plans. Use tpltz\-\_\-cleanup afterwards. \begin{DoxySeeAlso}{See also}
\hyperlink{group__group11_gac7ac0ee5f6eaee6846814b131671f6e8}{tpltz\-\_\-cleanup} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em T} & Toeplitz matrix. \\
\hline
{\em fft\-\_\-size} & effective F\-F\-T size for the circulant matrix (usually equal to blocksize) \\
\hline
{\em lambda} & Toeplitz band width. \\
\hline
{\em T\-\_\-fft} & complex array used for F\-F\-Ts. \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00392}{392} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_ga2c399885221722e98f72206ddce8d0d3}{\index{low-\/level routines@{low-\/level routines}!scmm\-\_\-direct@{scmm\-\_\-direct}}
\index{scmm\-\_\-direct@{scmm\-\_\-direct}!low-level routines@{low-\/level routines}}
\subsubsection[{scmm\-\_\-direct}]{\setlength{\rightskip}{0pt plus 5cm}int scmm\-\_\-direct (
\begin{DoxyParamCaption}
\item[{int}]{fft\-\_\-size, }
\item[{int}]{nfft, }
\item[{fftw\-\_\-complex $\ast$}]{C\-\_\-fft, }
\item[{int}]{ncol, }
\item[{double $\ast$}]{V\-\_\-rfft, }
\item[{double $\ast$$\ast$}]{C\-V, }
\item[{fftw\-\_\-complex $\ast$}]{V\-\_\-fft, }
\item[{fftw\-\_\-plan}]{plan\-\_\-f\-\_\-\-V, }
\item[{fftw\-\_\-plan}]{plan\-\_\-b\-\_\-\-C\-V}
\end{DoxyParamCaption}
)}}\label{group__group21_ga2c399885221722e98f72206ddce8d0d3}


Performs the product of a circulant matrix C\-\_\-fft by a matrix V\-\_\-rfft using fftw plans. 

Performs the product of a circulant matrix C\-\_\-fft by a matrix V\-\_\-rfft using fftw plans\-: forward -\/ plan\-\_\-f\-\_\-\-V; and backward -\/ plan\-\_\-b\-\_\-\-C\-V. C\-\_\-fft is a Fourier (complex representation of the circulant matrix) of length fft\-\_\-size/2+1; V\-\_\-rfft is a matrix with ncol columns and fft\-\_\-size rows; V\-\_\-fft is a workspace of fft\-\_\-size/2+1 complex numbers as required by the backward F\-F\-T (plan\-\_\-b\-\_\-\-C\-V); C\-V is the output matrix of the same size as the input V\-\_\-rfft one. The F\-F\-Ts transform ncol vectors simultanously. 
\begin{DoxyParams}[1]{Parameters}
 & {\em fft\-\_\-size} & row dimension \\
\hline
 & {\em nfft} & number of simultaneous F\-F\-Ts \\
\hline
 & {\em C\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
 & {\em ncol} & column dimension \\
\hline
 & {\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
\mbox{\tt out}  & {\em C\-V} & product of the circulant matrix C\-\_\-fft by the matrix V\-\_\-rfft \\
\hline
 & {\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
 & {\em plan\-\_\-f\-\_\-\-V} & fftw plan forward (r2c) \\
\hline
 & {\em plan\-\_\-b\-\_\-\-C\-V} & fftw plan backward (c2r) \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00509}{509} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_gab8839f416f8f8165b31a5363c405428d}{\index{low-\/level routines@{low-\/level routines}!scmm\-\_\-basic@{scmm\-\_\-basic}}
\index{scmm\-\_\-basic@{scmm\-\_\-basic}!low-level routines@{low-\/level routines}}
\subsubsection[{scmm\-\_\-basic}]{\setlength{\rightskip}{0pt plus 5cm}int scmm\-\_\-basic (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{blocksize, }
\item[{int}]{m, }
\item[{fftw\-\_\-complex $\ast$}]{C\-\_\-fft, }
\item[{double $\ast$$\ast$}]{C\-V, }
\item[{fftw\-\_\-complex $\ast$}]{V\-\_\-fft, }
\item[{double $\ast$}]{V\-\_\-rfft, }
\item[{int}]{nfft, }
\item[{fftw\-\_\-plan}]{plan\-\_\-f\-\_\-\-V, }
\item[{fftw\-\_\-plan}]{plan\-\_\-b\-\_\-\-C\-V}
\end{DoxyParamCaption}
)}}\label{group__group21_gab8839f416f8f8165b31a5363c405428d}


Performs the product of a circulant matrix by a matrix using F\-F\-T's (an I\-N\-T\-E\-R\-N\-A\-L routine) 

This routine multiplies a circulant matrix, represented by C\-\_\-fft, by a general matrix V, and stores the output as a matrix C\-V. In addition the routine requires two workspace objects, V\-\_\-fft and V\-\_\-rfft, to be allocated prior to a call to it as well as two fftw plans\-: one forward (plan\-\_\-f\-\_\-\-V), and one backward (plan\-\_\-b\-\_\-\-T\-V). The sizes of the input general matrix V and the ouput C\-V are given by blocksize rows and m columns. They are stored as a vector in the column-\/wise order. The circulant matrix, which is assumed to be band-\/diagonal with a band-\/width lambda, is represented by a Fourier transform with its coefficients stored in a vector C\-\_\-fft (length blocksize). blocksize also defines the size of the F\-F\-Ts, which will be performed and therefore this is the value which has to be used while creating the fftw plans and allocating the workspaces. The latter are given as\-: nfft$\ast$(blocksize/2+1) for V\-\_\-fft and nfft$\ast$blocksize for V\-\_\-rfft. The fftw plans should correspond to doing the transforms of nfft vectors simultaneously. Typically, the parameters of this routine are fixed by a preceding call to Toeplitz\-\_\-init(). The parameters are \-: 
\begin{DoxyParams}[1]{Parameters}
 & {\em V} & matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) \\
\hline
 & {\em blocksize} & row dimension of V \\
\hline
 & {\em m} & column dimension of V \\
\hline
 & {\em C\-\_\-fft} & complex array used for F\-F\-Ts (F\-F\-T of the Toeplitz matrix) \\
\hline
\mbox{\tt out}  & {\em C\-V} & product of the circulant matrix C\-\_\-fft by the matrix V\-\_\-rfft \\
\hline
 & {\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
 & {\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
 & {\em nfft} & number of simultaneous F\-F\-Ts \\
\hline
 & {\em plan\-\_\-f\-\_\-\-V} & fftw plan forward (r2c) \\
\hline
 & {\em plan\-\_\-b\-\_\-\-C\-V} & fftw plan backward (c2r) \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00587}{587} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_ga2731f1bbfce2d47c4cc3381150470da4}{\index{low-\/level routines@{low-\/level routines}!stmm\-\_\-core@{stmm\-\_\-core}}
\index{stmm\-\_\-core@{stmm\-\_\-core}!low-level routines@{low-\/level routines}}
\subsubsection[{stmm\-\_\-core}]{\setlength{\rightskip}{0pt plus 5cm}int stmm\-\_\-core (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{n, }
\item[{int}]{m, }
\item[{double $\ast$}]{T, }
\item[{fftw\-\_\-complex $\ast$}]{T\-\_\-fft, }
\item[{int}]{blocksize, }
\item[{int}]{lambda, }
\item[{fftw\-\_\-complex $\ast$}]{V\-\_\-fft, }
\item[{double $\ast$}]{V\-\_\-rfft, }
\item[{int}]{nfft, }
\item[{fftw\-\_\-plan}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan}]{plan\-\_\-b, }
\item[{int}]{flag\-\_\-offset, }
\item[{int}]{flag\-\_\-nofft}
\end{DoxyParamCaption}
)}}\label{group__group21_ga2731f1bbfce2d47c4cc3381150470da4}


Performs the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. (an I\-N\-T\-E\-R\-N\-A\-L routine) 

The product is performed block-\/by-\/block with a defined block size or a computed optimized block size that reflects a trade off between cost of a single F\-F\-T of a length block\-\_\-size and a number of blocks needed to perform the mutiplicaton. The latter determines how many spurious values are computed extra due to overlaps between the blocks. Use flag\-\_\-offset=0 for \char`\"{}classic\char`\"{} algorithm and flag\-\_\-offset=1 to put an offset to avoid the first and last lambdas terms. Usefull when a reshaping was done before with optimal column for a nfft. Better be inside the arguments of the routine. The parameters are\-: 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em n} & number of rows of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em T} & Toeplitz matrix data composed of the non-\/zero entries of his first row \\
\hline
{\em T\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em blocksize} & block size used in the sliding window algorithm \\
\hline
{\em lambda} & Toeplitz band width \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em nfft} & number of simultaneous F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
{\em flag\-\_\-offset} & flag to avoid extra 2$\ast$lambda padding to zeros on the edges \\
\hline
{\em flag\-\_\-nofft} & flag to do product without using fft \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00659}{659} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_gace7322011cd24b469e9b5d530e8a71ba}{\index{low-\/level routines@{low-\/level routines}!stmm\-\_\-main@{stmm\-\_\-main}}
\index{stmm\-\_\-main@{stmm\-\_\-main}!low-level routines@{low-\/level routines}}
\subsubsection[{stmm\-\_\-main}]{\setlength{\rightskip}{0pt plus 5cm}int stmm\-\_\-main (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{n, }
\item[{int}]{m, }
\item[{int}]{id0, }
\item[{int}]{l, }
\item[{double $\ast$}]{T, }
\item[{fftw\-\_\-complex $\ast$}]{T\-\_\-fft, }
\item[{int}]{lambda, }
\item[{fftw\-\_\-complex $\ast$}]{V\-\_\-fft, }
\item[{double $\ast$}]{V\-\_\-rfft, }
\item[{fftw\-\_\-plan}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan}]{plan\-\_\-b, }
\item[{int}]{blocksize, }
\item[{int}]{nfft, }
\item[{{\bf Flag}}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}}\label{group__group21_gace7322011cd24b469e9b5d530e8a71ba}


Performs the product of a Toeplitz matrix by a general matrix using the sliding window algorithm with optimize reshaping. (an I\-N\-T\-E\-R\-N\-A\-L routine) 

The input matrix is formatted into an optimized matrix depending on the block size and the number of simultaneous ffts (defined with the variable nfft). The obtained number of columns represent the number of vectors F\-F\-Ts of which are computed simulatenously. The multiplication is then performed block-\/by-\/block with the chosen block size using the core routine. The parameters are \-: 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em n} & number of rows of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em id0} & first index of V \\
\hline
{\em l} & length of V \\
\hline
{\em T} & Toeplitz matrix data composed of the non-\/zero entries of his first row \\
\hline
{\em T\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em lambda} & Toeplitz band width \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
{\em blocksize} & block size \\
\hline
{\em nfft} & number of simultaneous F\-T\-Ts \\
\hline
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz_8c_source_l00803}{803} of file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.

\hypertarget{group__group21_gaf6b3f49e179ac9ed28354ddd7dbb6a04}{\index{low-\/level routines@{low-\/level routines}!build\-\_\-gappy\-\_\-blocks@{build\-\_\-gappy\-\_\-blocks}}
\index{build\-\_\-gappy\-\_\-blocks@{build\-\_\-gappy\-\_\-blocks}!low-level routines@{low-\/level routines}}
\subsubsection[{build\-\_\-gappy\-\_\-blocks}]{\setlength{\rightskip}{0pt plus 5cm}int build\-\_\-gappy\-\_\-blocks (
\begin{DoxyParamCaption}
\item[{int}]{nrow, }
\item[{int}]{m, }
\item[{{\bf Block} $\ast$}]{tpltzblocks, }
\item[{int}]{nb\-\_\-blocks\-\_\-local, }
\item[{int}]{nb\-\_\-blocks\-\_\-all, }
\item[{int64\-\_\-t $\ast$}]{id0gap, }
\item[{int $\ast$}]{lgap, }
\item[{int}]{ngap, }
\item[{{\bf Block} $\ast$}]{tpltzblocks\-\_\-gappy, }
\item[{int $\ast$}]{nb\-\_\-blocks\-\_\-gappy\-\_\-final, }
\item[{int}]{flag\-\_\-param\-\_\-distmin\-\_\-fixed}
\end{DoxyParamCaption}
)}}\label{group__group21_gaf6b3f49e179ac9ed28354ddd7dbb6a04}


Build the gappy Toeplitz block structure to optimise the product computation at gaps location. 

Considering the significant gaps, the blocks to which they belong are cut and split between the gap's edges to reduce the total row size of the flotting blocks. It take into consideration the minimum correlation length and a parameter that allows us to control the minimum gap size allowed to split the blocks. In some cases, the gap can be partially reduce to fit the minimum block size needed for computation or just for performance criteria. This is based on the fact that the gaps are previously set to zeros before calling this routine. 
\begin{DoxyParams}{Parameters}
{\em nrow} & number of rows of the global data matrix V \\
\hline
{\em m} & number of columns for the data matrix V in the global rowwise order \\
\hline
{\em tpltzblocks} & list of the toeplitz blocks struture with its own parameters (idv, n, T\-\_\-block, lambda). \\
\hline
{\em nb\-\_\-blocks\-\_\-local} & number of Toeplitz blocks as stored in T \\
\hline
{\em nb\-\_\-blocks\-\_\-all} & number of all Toeplitz block on the diagonal of the full Toeplitz matrix \\
\hline
{\em id0gap} & index of the first element of each defined gap \\
\hline
{\em lgap} & length of each defined gaps \\
\hline
{\em ngap} & number of defined gaps \\
\hline
{\em tpltzblocks\-\_\-gappy} & list of the gappy toeplitz blocks struture with its own parameters \\
\hline
{\em nb\-\_\-blocks\-\_\-gappy\-\_\-final} & real number of obtained gappy Toeplitz blocks \\
\hline
{\em flag\-\_\-param\-\_\-distmin\-\_\-fixed} & flag to defined the minimum gap value allowed to split a Toeplitz block \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__gappy_8c_source_l00231}{231} of file \hyperlink{toeplitz__gappy_8c_source}{toeplitz\-\_\-gappy.\-c}.

\hypertarget{group__group21_gaf19f51ef406bebdb5e9400b6f9962077}{\index{low-\/level routines@{low-\/level routines}!stmm\-\_\-simple\-\_\-basic@{stmm\-\_\-simple\-\_\-basic}}
\index{stmm\-\_\-simple\-\_\-basic@{stmm\-\_\-simple\-\_\-basic}!low-level routines@{low-\/level routines}}
\subsubsection[{stmm\-\_\-simple\-\_\-basic}]{\setlength{\rightskip}{0pt plus 5cm}int stmm\-\_\-simple\-\_\-basic (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{n, }
\item[{int}]{m, }
\item[{double $\ast$}]{T, }
\item[{int}]{lambda, }
\item[{double $\ast$$\ast$}]{T\-V}
\end{DoxyParamCaption}
)}}\label{group__group21_gaf19f51ef406bebdb5e9400b6f9962077}


Perform the product of a Toeplitz matrix by a matrix without using F\-F\-T's. 

This routine multiplies the values directly between them. This exploit the fact that the bandwith is small compared to the matrix size. The number of operation is then no more than (lambda$\ast$2-\/1) multiplications and (lambda$\ast$2-\/1)-\/1 additions per row. 

Definition at line \hyperlink{toeplitz__nofft_8c_source_l00073}{73} of file \hyperlink{toeplitz__nofft_8c_source}{toeplitz\-\_\-nofft.\-c}.

\hypertarget{group__group21_ga516de87d3daf22f1a29ba390d5e57caa}{\index{low-\/level routines@{low-\/level routines}!stmm\-\_\-simple\-\_\-core@{stmm\-\_\-simple\-\_\-core}}
\index{stmm\-\_\-simple\-\_\-core@{stmm\-\_\-simple\-\_\-core}!low-level routines@{low-\/level routines}}
\subsubsection[{stmm\-\_\-simple\-\_\-core}]{\setlength{\rightskip}{0pt plus 5cm}int stmm\-\_\-simple\-\_\-core (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{n, }
\item[{int}]{m, }
\item[{double $\ast$}]{T, }
\item[{int}]{blocksize, }
\item[{int}]{lambda, }
\item[{int}]{nfft, }
\item[{int}]{flag\-\_\-offset}
\end{DoxyParamCaption}
)}}\label{group__group21_ga516de87d3daf22f1a29ba390d5e57caa}


Perform the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. 

The product is performed block-\/by-\/block with a defined block size or a computed optimized blocksize. This routine is not used by th A\-P\-I. 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em n} & number of rows of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em T} & Toeplitz matrix data composed of the non-\/zero entries of his first row \\
\hline
{\em blocksize} & block size used in the sliding window algorithm \\
\hline
{\em lambda} & Toeplitz band width \\
\hline
{\em nfft} & number of simultaneous F\-F\-Ts \\
\hline
{\em flag\-\_\-offset} & flag to avoid extra 2$\ast$lambda padding to zeros on the edges \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__nofft_8c_source_l00128}{128} of file \hyperlink{toeplitz__nofft_8c_source}{toeplitz\-\_\-nofft.\-c}.

\hypertarget{group__group21_ga234bcc963a99bea09ed92b36c711c3ec}{\index{low-\/level routines@{low-\/level routines}!flag\-\_\-stgy\-\_\-init\-\_\-auto@{flag\-\_\-stgy\-\_\-init\-\_\-auto}}
\index{flag\-\_\-stgy\-\_\-init\-\_\-auto@{flag\-\_\-stgy\-\_\-init\-\_\-auto}!low-level routines@{low-\/level routines}}
\subsubsection[{flag\-\_\-stgy\-\_\-init\-\_\-auto}]{\setlength{\rightskip}{0pt plus 5cm}int flag\-\_\-stgy\-\_\-init\-\_\-auto (
\begin{DoxyParamCaption}
\item[{{\bf Flag} $\ast$}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}}\label{group__group21_ga234bcc963a99bea09ed92b36c711c3ec}


Set the flag to automatic paramaters. 


\begin{DoxyParams}{Parameters}
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__params_8c_source_l00073}{73} of file \hyperlink{toeplitz__params_8c_source}{toeplitz\-\_\-params.\-c}.

\hypertarget{group__group21_ga6de858af090da4b96df6a195015ce09e}{\index{low-\/level routines@{low-\/level routines}!flag\-\_\-stgy\-\_\-init\-\_\-zeros@{flag\-\_\-stgy\-\_\-init\-\_\-zeros}}
\index{flag\-\_\-stgy\-\_\-init\-\_\-zeros@{flag\-\_\-stgy\-\_\-init\-\_\-zeros}!low-level routines@{low-\/level routines}}
\subsubsection[{flag\-\_\-stgy\-\_\-init\-\_\-zeros}]{\setlength{\rightskip}{0pt plus 5cm}int flag\-\_\-stgy\-\_\-init\-\_\-zeros (
\begin{DoxyParamCaption}
\item[{{\bf Flag} $\ast$}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}}\label{group__group21_ga6de858af090da4b96df6a195015ce09e}


Set the flag parameters to zeros. This is almost the same as automatic. 


\begin{DoxyParams}{Parameters}
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__params_8c_source_l00091}{91} of file \hyperlink{toeplitz__params_8c_source}{toeplitz\-\_\-params.\-c}.

\hypertarget{group__group21_gae334670891033aa91dd0bb7f8b707dc4}{\index{low-\/level routines@{low-\/level routines}!flag\-\_\-stgy\-\_\-init\-\_\-defined@{flag\-\_\-stgy\-\_\-init\-\_\-defined}}
\index{flag\-\_\-stgy\-\_\-init\-\_\-defined@{flag\-\_\-stgy\-\_\-init\-\_\-defined}!low-level routines@{low-\/level routines}}
\subsubsection[{flag\-\_\-stgy\-\_\-init\-\_\-defined}]{\setlength{\rightskip}{0pt plus 5cm}int flag\-\_\-stgy\-\_\-init\-\_\-defined (
\begin{DoxyParamCaption}
\item[{{\bf Flag} $\ast$}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}}\label{group__group21_gae334670891033aa91dd0bb7f8b707dc4}


Set the parameters flag to the defined ones. 


\begin{DoxyParams}{Parameters}
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__params_8c_source_l00106}{106} of file \hyperlink{toeplitz__params_8c_source}{toeplitz\-\_\-params.\-c}.

\hypertarget{group__group21_ga2d566ebeba6474d1bbac93315e1f578a}{\index{low-\/level routines@{low-\/level routines}!print\-\_\-flag\-\_\-stgy\-\_\-init@{print\-\_\-flag\-\_\-stgy\-\_\-init}}
\index{print\-\_\-flag\-\_\-stgy\-\_\-init@{print\-\_\-flag\-\_\-stgy\-\_\-init}!low-level routines@{low-\/level routines}}
\subsubsection[{print\-\_\-flag\-\_\-stgy\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int print\-\_\-flag\-\_\-stgy\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf Flag}}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}}\label{group__group21_ga2d566ebeba6474d1bbac93315e1f578a}


Print the flag parameters values. 


\begin{DoxyParams}{Parameters}
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{toeplitz__params_8c_source_l00131}{131} of file \hyperlink{toeplitz__params_8c_source}{toeplitz\-\_\-params.\-c}.

