\section{toeplitz.\-c File Reference}
\label{toeplitz_8c}\index{toeplitz.\-c@{toeplitz.\-c}}


Contains the main part of the sequential routines for Toeplitz algebra.  


{\ttfamily \#include \char`\"{}toeplitz.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{toeplitz_8c_a24331a8efb6e0b77df7c645ef45b2830}{print\-\_\-error\-\_\-message} (int error\-\_\-number, char const $\ast$file, int line)
\begin{DoxyCompactList}\small\item\em Prints error message corresponding to an error number. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a186fc8d8825da293e94de77b77d01fba}{define\-\_\-blocksize} (int n, int lambda, int bs\-\_\-flag, int fixed\-\_\-bs)
\begin{DoxyCompactList}\small\item\em Defines an optimal size of the block used in the sliding windows algorithm. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a4c2846ca9f67faae5746325d1ec63aac}{define\-\_\-nfft} (int n\-\_\-thread, int flag\-\_\-nfft, int fixed\-\_\-nfft)
\begin{DoxyCompactList}\small\item\em Defines the number of simultaneous ffts for the Toeplitz matrix product computation. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a7f4e77d71f2c6f2caf652bab7520e3f4}{tpltz\-\_\-init} (int n, int lambda, int $\ast$nfft, int $\ast$blocksize, fftw\-\_\-complex $\ast$$\ast$T\-\_\-fft, double $\ast$T, fftw\-\_\-complex $\ast$$\ast$V\-\_\-fft, double $\ast$$\ast$V\-\_\-rfft, fftw\-\_\-plan $\ast$plan\-\_\-f, fftw\-\_\-plan $\ast$plan\-\_\-b, Flag flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Sets a block size and initializes all fftw arrays and plans needed for the computation. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_ae3d694bcffacaf24706f0586a223538e}{fftw\-\_\-init\-\_\-omp\-\_\-threads} (int fftw\-\_\-n\-\_\-thread)
\begin{DoxyCompactList}\small\item\em Initialize omp threads for fftw plans. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a1a6106fbaa68aab85595935252299097}{rhs\-\_\-init\-\_\-fftw} (int $\ast$nfft, int fft\-\_\-size, fftw\-\_\-complex $\ast$$\ast$V\-\_\-fft, double $\ast$$\ast$V\-\_\-rfft, fftw\-\_\-plan $\ast$plan\-\_\-f, fftw\-\_\-plan $\ast$plan\-\_\-b, int fftw\-\_\-flag)
\begin{DoxyCompactList}\small\item\em Initializes fftw array and plan for the right hand side, general matrix V. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a6c68921dafc6dc184d335a59df68e5f7}{circ\-\_\-init\-\_\-fftw} (double $\ast$T, int fft\-\_\-size, int lambda, fftw\-\_\-complex $\ast$$\ast$T\-\_\-fft)
\begin{DoxyCompactList}\small\item\em Initializes fftw array and plan for the circulant matrix T\-\_\-circ obtained from T. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_ac7ac0ee5f6eaee6846814b131671f6e8}{tpltz\-\_\-cleanup} (fftw\-\_\-complex $\ast$$\ast$T\-\_\-fft, fftw\-\_\-complex $\ast$$\ast$V\-\_\-fft, double $\ast$$\ast$V\-\_\-rfft, fftw\-\_\-plan $\ast$plan\-\_\-f, fftw\-\_\-plan $\ast$plan\-\_\-b)
\begin{DoxyCompactList}\small\item\em Cleans fftw workspace used in the Toeplitz matrix matrix product's computation. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a7dddc7df6f787d6aa92dfc25e9d0465a}{copy\-\_\-block} (int ninrow, int nincol, double $\ast$Vin, int noutrow, int noutcol, double $\ast$Vout, int inrow, int incol, int nblockrow, int nblockcol, int outrow, int outcol, double norm, int set\-\_\-zero\-\_\-flag)
\begin{DoxyCompactList}\small\item\em Copies (and potentially reshapes) a selected block of the input matrix to a specified position of the output matrix. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a2c399885221722e98f72206ddce8d0d3}{scmm\-\_\-direct} (int fft\-\_\-size, int nfft, fftw\-\_\-complex $\ast$C\-\_\-fft, int ncol, double $\ast$V\-\_\-rfft, double $\ast$$\ast$C\-V, fftw\-\_\-complex $\ast$V\-\_\-fft, fftw\-\_\-plan plan\-\_\-f\-\_\-\-V, fftw\-\_\-plan plan\-\_\-b\-\_\-\-C\-V)
\begin{DoxyCompactList}\small\item\em Performs the product of a circulant matrix C\-\_\-fft by a matrix V\-\_\-rfft using fftw plans. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_ab8839f416f8f8165b31a5363c405428d}{scmm\-\_\-basic} (double $\ast$$\ast$V, int blocksize, int m, fftw\-\_\-complex $\ast$C\-\_\-fft, double $\ast$$\ast$C\-V, fftw\-\_\-complex $\ast$V\-\_\-fft, double $\ast$V\-\_\-rfft, int nfft, fftw\-\_\-plan plan\-\_\-f\-\_\-\-V, fftw\-\_\-plan plan\-\_\-b\-\_\-\-C\-V)
\begin{DoxyCompactList}\small\item\em Performs the product of a circulant matrix by a matrix using F\-F\-T's (an I\-N\-T\-E\-R\-N\-A\-L routine) \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a2731f1bbfce2d47c4cc3381150470da4}{stmm\-\_\-core} (double $\ast$$\ast$V, int n, int m, double $\ast$T, fftw\-\_\-complex $\ast$T\-\_\-fft, int blocksize, int lambda, fftw\-\_\-complex $\ast$V\-\_\-fft, double $\ast$V\-\_\-rfft, int nfft, fftw\-\_\-plan plan\-\_\-f, fftw\-\_\-plan plan\-\_\-b, int flag\-\_\-offset, int flag\-\_\-nofft)
\begin{DoxyCompactList}\small\item\em Performs the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. (an I\-N\-T\-E\-R\-N\-A\-L routine) \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_ace7322011cd24b469e9b5d530e8a71ba}{stmm\-\_\-main} (double $\ast$$\ast$V, int n, int m, int id0, int l, double $\ast$T, fftw\-\_\-complex $\ast$T\-\_\-fft, int lambda, fftw\-\_\-complex $\ast$V\-\_\-fft, double $\ast$V\-\_\-rfft, fftw\-\_\-plan plan\-\_\-f, fftw\-\_\-plan plan\-\_\-b, int blocksize, int nfft, Flag flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Performs the product of a Toeplitz matrix by a general matrix using the sliding window algorithm with optimize reshaping. (an I\-N\-T\-E\-R\-N\-A\-L routine) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{toeplitz_8c_ab848ce91ba14d3dc5c87d0b42f3a1c0d}{V\-E\-R\-B\-O\-S\-E}
\begin{DoxyCompactList}\small\item\em Verbose mode. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz_8c_a005f790383498397d0fdad1513881e3f}{V\-E\-R\-B\-O\-S\-E\-\_\-\-F\-I\-R\-S\-T\-I\-N\-I\-T} = 1
\item 
int \hyperlink{toeplitz_8c_a300d52d9923297872ffb24962a0f0ce6}{P\-R\-I\-N\-T\-\_\-\-R\-A\-N\-K} = -\/1
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Contains the main part of the sequential routines for Toeplitz algebra. version 1.\-2b, November 2012 \begin{DoxyAuthor}{Author}
Frederic Dauvergne, Maude Le Jeune, Antoine Rogier, Radek Stompor
\end{DoxyAuthor}
Project\-: Midapack library, A\-N\-R M\-I\-D\-A\-S'09 -\/ Toeplitz Algebra module Purpose\-: Provide Toeplitz algebra tools suitable for Cosmic Microwave Background (C\-M\-B) data analysis.

\begin{DoxyNote}{Note}
Copyright (c) 2010-\/2012 A\-P\-C C\-N\-R\-S Université Paris Diderot 



This program is free software; you can redistribute it and/or modify it under the terms 

of the G\-N\-U Lesser General Public License as published by the Free Software Foundation; 

either version 3 of the License, or (at your option) any later version. This program is 

distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even 

the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U 

Lesser General Public License for more details. 



You should have received a copy of the G\-N\-U Lesser General Public License along with this 

program; if not, see \href{http://www.gnu.org/licenses/lgpl.html}{\tt http\-://www.\-gnu.\-org/licenses/lgpl.\-html} 



For more information about A\-N\-R M\-I\-D\-A\-S'09 project see \-: 

\href{http://www.apc.univ-paris7.fr/APC_CS/Recherche/Adamis/MIDAS09/index.html}{\tt http\-://www.\-apc.\-univ-\/paris7.\-fr/\-A\-P\-C\-\_\-\-C\-S/\-Recherche/\-Adamis/\-M\-I\-D\-A\-S09/index.\-html} 



A\-C\-K\-N\-O\-W\-L\-E\-D\-G\-M\-E\-N\-T\-: This work has been supported in part by the French National Research 

Agency (A\-N\-R) through C\-O\-S\-I\-N\-U\-S program (project M\-I\-D\-A\-S no. A\-N\-R-\/09-\/\-C\-O\-S\-I-\/009).
\end{DoxyNote}
Log\-: toeplitz$\ast$.c

Revision 1.\-0b 2012/05/07 Frederic Dauvergne (A\-P\-C) Official release 1.\-0beta. The first installement of the library is the Toeplitz algebra module.

Revision 1.\-1b 2012/07/-\/ Frederic Dauvergne (A\-P\-C)
\begin{DoxyItemize}
\item mpi\-\_\-stbmm allows now rowi-\/wise order per process datas and no-\/blocking communications.
\item O\-M\-P improvment for optimal cpu time.
\item bug fixed for O\-M\-P in the stmm\-\_\-basic routine.
\item distcorrmin is used to communicate only lambda-\/1 datas when it is needed.
\item new reshaping routines using transformation functions in stmm. Thus, only one copy at most is needed.
\item tpltz\-\_\-init improvement using define\-\_\-nfft and define\-\_\-blocksize routines.
\item add Block struture to define each Toeplitz block.
\item add Flag structure and preprocessing parameters to define the computational strategy. All the flag parameters are then available directly from the A\-P\-I.
\end{DoxyItemize}

Revision 1.\-2b 2012/11/30 Frederic Dauvergne (A\-P\-C)
\begin{DoxyItemize}
\item extend the mpi product routine to rowwise order data distribution. This is now allowing tree kinds of distribution.
\item add int64 for some variables to extend the global volume of data you can use.
\item Openmp improvments.
\item Add \hyperlink{toeplitz__wizard_8c}{toeplitz\-\_\-wizard.\-c}, which contains a set of easy to use routines with defined structures. 
\end{DoxyItemize}

Definition in file \hyperlink{toeplitz_8c_source}{toeplitz.\-c}.



\subsection{Function Documentation}
\index{toeplitz.\-c@{toeplitz.\-c}!print\-\_\-error\-\_\-message@{print\-\_\-error\-\_\-message}}
\index{print\-\_\-error\-\_\-message@{print\-\_\-error\-\_\-message}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{print\-\_\-error\-\_\-message}]{\setlength{\rightskip}{0pt plus 5cm}int print\-\_\-error\-\_\-message (
\begin{DoxyParamCaption}
\item[{int}]{error\-\_\-number, }
\item[{char const $\ast$}]{file, }
\item[{int}]{line}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a24331a8efb6e0b77df7c645ef45b2830}


Prints error message corresponding to an error number. 


\begin{DoxyParams}{Parameters}
{\em error\-\_\-number} & error number \\
\hline
{\em file} & file name \\
\hline
{\em line} & line number \\
\hline
\end{DoxyParams}


Definition at line 93 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!define\-\_\-blocksize@{define\-\_\-blocksize}}
\index{define\-\_\-blocksize@{define\-\_\-blocksize}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{define\-\_\-blocksize}]{\setlength{\rightskip}{0pt plus 5cm}int define\-\_\-blocksize (
\begin{DoxyParamCaption}
\item[{int}]{n, }
\item[{int}]{lambda, }
\item[{int}]{bs\-\_\-flag, }
\item[{int}]{fixed\-\_\-bs}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a186fc8d8825da293e94de77b77d01fba}


Defines an optimal size of the block used in the sliding windows algorithm. 

The optimal block size is computed as the minimum power of two above 3$\ast$lambda, i.\-e. the smallest value equal to 2$^\wedge$x, where x is an integer, and above 3$\ast$lambda. If bs\-\_\-flag is set to one, a different formula is used to compute the optimal block size (see M\-A\-Dmap\-: A M\-A\-S\-S\-I\-V\-E\-L\-Y P\-A\-R\-A\-L\-L\-E\-L M\-A\-X\-I\-M\-U\-M L\-I\-K\-E\-L\-I\-H\-O\-O\-D C\-O\-S\-M\-I\-C M\-I\-C\-R\-O\-W\-A\-V\-E B\-A\-C\-K\-G\-R\-O\-U\-N\-D M\-A\-P-\/\-M\-A\-K\-E\-R, C. M. Cantalupo, J. D. Borrill, A. H. Jaffe, T. S. Kisner, and R. Stompor, The Astrophysical Journal Supplement Series, 187\-:212–227, 2010 March). To avoid using block size much bigger than the matrix, the block size is set to 3$\ast$lambda when his previous computed size is bigger than the matrix size n. This case append mostly for small matrix compared to his bandwith. 
\begin{DoxyParams}{Parameters}
{\em n} & matrix row dimension \\
\hline
{\em lambda} & half bandwidth of the Toeplitz matrix \\
\hline
{\em bs\-\_\-flag} & flag to use a different formula for optimal block size computation \\
\hline
{\em fixed\-\_\-bs} & fixed blocksize value if needed \\
\hline
\end{DoxyParams}


Definition at line 130 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!define\-\_\-nfft@{define\-\_\-nfft}}
\index{define\-\_\-nfft@{define\-\_\-nfft}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{define\-\_\-nfft}]{\setlength{\rightskip}{0pt plus 5cm}int define\-\_\-nfft (
\begin{DoxyParamCaption}
\item[{int}]{n\-\_\-thread, }
\item[{int}]{flag\-\_\-nfft, }
\item[{int}]{fixed\-\_\-nfft}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a4c2846ca9f67faae5746325d1ec63aac}


Defines the number of simultaneous ffts for the Toeplitz matrix product computation. 


\begin{DoxyParams}{Parameters}
{\em n\-\_\-thread} & number of omp threads \\
\hline
{\em flag\-\_\-nfft} & flag to set the strategy to define nfft \\
\hline
{\em fixed\-\_\-nfft} & fixed nfft value if nedeed (used for the case where flag\-\_\-nfft=1) \\
\hline
\end{DoxyParams}


Definition at line 220 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!tpltz\-\_\-init@{tpltz\-\_\-init}}
\index{tpltz\-\_\-init@{tpltz\-\_\-init}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{tpltz\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int tpltz\-\_\-init (
\begin{DoxyParamCaption}
\item[{int}]{n, }
\item[{int}]{lambda, }
\item[{int $\ast$}]{nfft, }
\item[{int $\ast$}]{blocksize, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{T\-\_\-fft, }
\item[{double $\ast$}]{T, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{V\-\_\-fft, }
\item[{double $\ast$$\ast$}]{V\-\_\-rfft, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-b, }
\item[{Flag}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a7f4e77d71f2c6f2caf652bab7520e3f4}


Sets a block size and initializes all fftw arrays and plans needed for the computation. 

Initializes the fftw arrays and plans is necessary before any computation of the Toeplitz matrix matrix product. Use tpltz\-\_\-cleanup afterwards. \begin{DoxySeeAlso}{See also}
\hyperlink{toeplitz_8c_ac7ac0ee5f6eaee6846814b131671f6e8}{tpltz\-\_\-cleanup} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em n} & row size of the matrix used for later product \\
\hline
{\em lambda} & Toeplitz band width \\
\hline
{\em nfft} & maximum number of F\-F\-Ts you want to compute at the same time \\
\hline
{\em blocksize} & optimal block size used in the sliding window algorithm to compute an optimize value) \\
\hline
{\em T\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em T} & Toeplitz matrix \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
\end{DoxyParams}


Definition at line 257 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!fftw\-\_\-init\-\_\-omp\-\_\-threads@{fftw\-\_\-init\-\_\-omp\-\_\-threads}}
\index{fftw\-\_\-init\-\_\-omp\-\_\-threads@{fftw\-\_\-init\-\_\-omp\-\_\-threads}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{fftw\-\_\-init\-\_\-omp\-\_\-threads}]{\setlength{\rightskip}{0pt plus 5cm}int fftw\-\_\-init\-\_\-omp\-\_\-threads (
\begin{DoxyParamCaption}
\item[{int}]{fftw\-\_\-n\-\_\-thread}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_ae3d694bcffacaf24706f0586a223538e}


Initialize omp threads for fftw plans. 

Initialize omp threads for fftw plans. The number of threads used for ffts (define by the variable n\-\_\-thread) is read from O\-M\-P\-\_\-\-N\-U\-M\-\_\-\-T\-H\-R\-E\-A\-D environment variable. fftw multithreaded option is controlled by fftw\-\_\-\-M\-U\-L\-T\-I\-T\-H\-R\-E\-A\-D\-I\-N\-G macro. 

Definition at line 333 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!rhs\-\_\-init\-\_\-fftw@{rhs\-\_\-init\-\_\-fftw}}
\index{rhs\-\_\-init\-\_\-fftw@{rhs\-\_\-init\-\_\-fftw}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{rhs\-\_\-init\-\_\-fftw}]{\setlength{\rightskip}{0pt plus 5cm}int rhs\-\_\-init\-\_\-fftw (
\begin{DoxyParamCaption}
\item[{int $\ast$}]{nfft, }
\item[{int}]{fft\-\_\-size, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{V\-\_\-fft, }
\item[{double $\ast$$\ast$}]{V\-\_\-rfft, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-b, }
\item[{int}]{fftw\-\_\-flag}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a1a6106fbaa68aab85595935252299097}


Initializes fftw array and plan for the right hand side, general matrix V. 

Initialize fftw array and plan for the right hand side matrix V. 
\begin{DoxyParams}{Parameters}
{\em nfft} & maximum number of F\-F\-Ts you want to compute at the same time \\
\hline
{\em fft\-\_\-size} & effective F\-F\-T size for the general matrix V (usually equal to blocksize) \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
{\em fftw\-\_\-flag} & fftw plan allocation flag \\
\hline
\end{DoxyParams}


Definition at line 365 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!circ\-\_\-init\-\_\-fftw@{circ\-\_\-init\-\_\-fftw}}
\index{circ\-\_\-init\-\_\-fftw@{circ\-\_\-init\-\_\-fftw}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{circ\-\_\-init\-\_\-fftw}]{\setlength{\rightskip}{0pt plus 5cm}int circ\-\_\-init\-\_\-fftw (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{T, }
\item[{int}]{fft\-\_\-size, }
\item[{int}]{lambda, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{T\-\_\-fft}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a6c68921dafc6dc184d335a59df68e5f7}


Initializes fftw array and plan for the circulant matrix T\-\_\-circ obtained from T. 

Builds the circulant matrix T\-\_\-circ from T and initilizes its fftw arrays and plans. Use tpltz\-\_\-cleanup afterwards. \begin{DoxySeeAlso}{See also}
\hyperlink{toeplitz_8c_ac7ac0ee5f6eaee6846814b131671f6e8}{tpltz\-\_\-cleanup} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em T} & Toeplitz matrix. \\
\hline
{\em fft\-\_\-size} & effective F\-F\-T size for the circulant matrix (usually equal to blocksize) \\
\hline
{\em lambda} & Toeplitz band width. \\
\hline
{\em T\-\_\-fft} & complex array used for F\-F\-Ts. \\
\hline
\end{DoxyParams}


Definition at line 392 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!tpltz\-\_\-cleanup@{tpltz\-\_\-cleanup}}
\index{tpltz\-\_\-cleanup@{tpltz\-\_\-cleanup}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{tpltz\-\_\-cleanup}]{\setlength{\rightskip}{0pt plus 5cm}int tpltz\-\_\-cleanup (
\begin{DoxyParamCaption}
\item[{fftw\-\_\-complex $\ast$$\ast$}]{T\-\_\-fft, }
\item[{fftw\-\_\-complex $\ast$$\ast$}]{V\-\_\-fft, }
\item[{double $\ast$$\ast$}]{V\-\_\-rfft, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan $\ast$}]{plan\-\_\-b}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_ac7ac0ee5f6eaee6846814b131671f6e8}


Cleans fftw workspace used in the Toeplitz matrix matrix product's computation. 

Destroy fftw plans, free memory and reset fftw workspace. \begin{DoxySeeAlso}{See also}
\hyperlink{toeplitz_8c_a7f4e77d71f2c6f2caf652bab7520e3f4}{tpltz\-\_\-init} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em T\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
\end{DoxyParams}


Definition at line 435 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!copy\-\_\-block@{copy\-\_\-block}}
\index{copy\-\_\-block@{copy\-\_\-block}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{copy\-\_\-block}]{\setlength{\rightskip}{0pt plus 5cm}int copy\-\_\-block (
\begin{DoxyParamCaption}
\item[{int}]{ninrow, }
\item[{int}]{nincol, }
\item[{double $\ast$}]{Vin, }
\item[{int}]{noutrow, }
\item[{int}]{noutcol, }
\item[{double $\ast$}]{Vout, }
\item[{int}]{inrow, }
\item[{int}]{incol, }
\item[{int}]{nblockrow, }
\item[{int}]{nblockcol, }
\item[{int}]{outrow, }
\item[{int}]{outcol, }
\item[{double}]{norm, }
\item[{int}]{set\-\_\-zero\-\_\-flag}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a7dddc7df6f787d6aa92dfc25e9d0465a}


Copies (and potentially reshapes) a selected block of the input matrix to a specified position of the output matrix. 

Copy a matrix block of a size nblockrow x nblockcol from the input matrix Vin (size ninrow x nincol) starting with the element (inrow, incol) to the output matrix Vout (size notrow x noutcol) starting with the element (outrow, outcol) after multiplying by norm. If the output matrix is larger than the block the extra elements are either left as they were on the input or zeroed if zero\-\_\-flag is set to 1. If the block to be copied is larger than either the input or the output matrix an error occurs. 

Definition at line 459 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!scmm\-\_\-direct@{scmm\-\_\-direct}}
\index{scmm\-\_\-direct@{scmm\-\_\-direct}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{scmm\-\_\-direct}]{\setlength{\rightskip}{0pt plus 5cm}int scmm\-\_\-direct (
\begin{DoxyParamCaption}
\item[{int}]{fft\-\_\-size, }
\item[{int}]{nfft, }
\item[{fftw\-\_\-complex $\ast$}]{C\-\_\-fft, }
\item[{int}]{ncol, }
\item[{double $\ast$}]{V\-\_\-rfft, }
\item[{double $\ast$$\ast$}]{C\-V, }
\item[{fftw\-\_\-complex $\ast$}]{V\-\_\-fft, }
\item[{fftw\-\_\-plan}]{plan\-\_\-f\-\_\-\-V, }
\item[{fftw\-\_\-plan}]{plan\-\_\-b\-\_\-\-C\-V}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a2c399885221722e98f72206ddce8d0d3}


Performs the product of a circulant matrix C\-\_\-fft by a matrix V\-\_\-rfft using fftw plans. 

Performs the product of a circulant matrix C\-\_\-fft by a matrix V\-\_\-rfft using fftw plans\-: forward -\/ plan\-\_\-f\-\_\-\-V; and backward -\/ plan\-\_\-b\-\_\-\-C\-V. C\-\_\-fft is a Fourier (complex representation of the circulant matrix) of length fft\-\_\-size/2+1; V\-\_\-rfft is a matrix with ncol columns and fft\-\_\-size rows; V\-\_\-fft is a workspace of fft\-\_\-size/2+1 complex numbers as required by the backward F\-F\-T (plan\-\_\-b\-\_\-\-C\-V); C\-V is the output matrix of the same size as the input V\-\_\-rfft one. The F\-F\-Ts transform ncol vectors simultanously. 
\begin{DoxyParams}[1]{Parameters}
 & {\em fft\-\_\-size} & row dimension \\
\hline
 & {\em nfft} & number of simultaneous F\-F\-Ts \\
\hline
 & {\em C\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
 & {\em ncol} & column dimension \\
\hline
 & {\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
\mbox{\tt out}  & {\em C\-V} & product of the circulant matrix C\-\_\-fft by the matrix V\-\_\-rfft \\
\hline
 & {\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
 & {\em plan\-\_\-f\-\_\-\-V} & fftw plan forward (r2c) \\
\hline
 & {\em plan\-\_\-b\-\_\-\-C\-V} & fftw plan backward (c2r) \\
\hline
\end{DoxyParams}


Definition at line 509 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!scmm\-\_\-basic@{scmm\-\_\-basic}}
\index{scmm\-\_\-basic@{scmm\-\_\-basic}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{scmm\-\_\-basic}]{\setlength{\rightskip}{0pt plus 5cm}int scmm\-\_\-basic (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{blocksize, }
\item[{int}]{m, }
\item[{fftw\-\_\-complex $\ast$}]{C\-\_\-fft, }
\item[{double $\ast$$\ast$}]{C\-V, }
\item[{fftw\-\_\-complex $\ast$}]{V\-\_\-fft, }
\item[{double $\ast$}]{V\-\_\-rfft, }
\item[{int}]{nfft, }
\item[{fftw\-\_\-plan}]{plan\-\_\-f\-\_\-\-V, }
\item[{fftw\-\_\-plan}]{plan\-\_\-b\-\_\-\-C\-V}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_ab8839f416f8f8165b31a5363c405428d}


Performs the product of a circulant matrix by a matrix using F\-F\-T's (an I\-N\-T\-E\-R\-N\-A\-L routine) 

This routine multiplies a circulant matrix, represented by C\-\_\-fft, by a general matrix V, and stores the output as a matrix C\-V. In addition the routine requires two workspace objects, V\-\_\-fft and V\-\_\-rfft, to be allocated prior to a call to it as well as two fftw plans\-: one forward (plan\-\_\-f\-\_\-\-V), and one backward (plan\-\_\-b\-\_\-\-T\-V). The sizes of the input general matrix V and the ouput C\-V are given by blocksize rows and m columns. They are stored as a vector in the column-\/wise order. The circulant matrix, which is assumed to be band-\/diagonal with a band-\/width lambda, is represented by a Fourier transform with its coefficients stored in a vector C\-\_\-fft (length blocksize). blocksize also defines the size of the F\-F\-Ts, which will be performed and therefore this is the value which has to be used while creating the fftw plans and allocating the workspaces. The latter are given as\-: nfft$\ast$(blocksize/2+1) for V\-\_\-fft and nfft$\ast$blocksize for V\-\_\-rfft. The fftw plans should correspond to doing the transforms of nfft vectors simultaneously. Typically, the parameters of this routine are fixed by a preceding call to Toeplitz\-\_\-init(). The parameters are \-: 
\begin{DoxyParams}[1]{Parameters}
 & {\em V} & matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) \\
\hline
 & {\em blocksize} & row dimension of V \\
\hline
 & {\em m} & column dimension of V \\
\hline
 & {\em C\-\_\-fft} & complex array used for F\-F\-Ts (F\-F\-T of the Toeplitz matrix) \\
\hline
\mbox{\tt out}  & {\em C\-V} & product of the circulant matrix C\-\_\-fft by the matrix V\-\_\-rfft \\
\hline
 & {\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
 & {\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
 & {\em nfft} & number of simultaneous F\-F\-Ts \\
\hline
 & {\em plan\-\_\-f\-\_\-\-V} & fftw plan forward (r2c) \\
\hline
 & {\em plan\-\_\-b\-\_\-\-C\-V} & fftw plan backward (c2r) \\
\hline
\end{DoxyParams}


Definition at line 587 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!stmm\-\_\-core@{stmm\-\_\-core}}
\index{stmm\-\_\-core@{stmm\-\_\-core}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{stmm\-\_\-core}]{\setlength{\rightskip}{0pt plus 5cm}int stmm\-\_\-core (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{n, }
\item[{int}]{m, }
\item[{double $\ast$}]{T, }
\item[{fftw\-\_\-complex $\ast$}]{T\-\_\-fft, }
\item[{int}]{blocksize, }
\item[{int}]{lambda, }
\item[{fftw\-\_\-complex $\ast$}]{V\-\_\-fft, }
\item[{double $\ast$}]{V\-\_\-rfft, }
\item[{int}]{nfft, }
\item[{fftw\-\_\-plan}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan}]{plan\-\_\-b, }
\item[{int}]{flag\-\_\-offset, }
\item[{int}]{flag\-\_\-nofft}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_a2731f1bbfce2d47c4cc3381150470da4}


Performs the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. (an I\-N\-T\-E\-R\-N\-A\-L routine) 

The product is performed block-\/by-\/block with a defined block size or a computed optimized block size that reflects a trade off between cost of a single F\-F\-T of a length block\-\_\-size and a number of blocks needed to perform the mutiplicaton. The latter determines how many spurious values are computed extra due to overlaps between the blocks. Use flag\-\_\-offset=0 for \char`\"{}classic\char`\"{} algorithm and flag\-\_\-offset=1 to put an offset to avoid the first and last lambdas terms. Usefull when a reshaping was done before with optimal column for a nfft. Better be inside the arguments of the routine. The parameters are\-: 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em n} & number of rows of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em T} & Toeplitz matrix data composed of the non-\/zero entries of his first row \\
\hline
{\em T\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em blocksize} & block size used in the sliding window algorithm \\
\hline
{\em lambda} & Toeplitz band width \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em nfft} & number of simultaneous F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
{\em flag\-\_\-offset} & flag to avoid extra 2$\ast$lambda padding to zeros on the edges \\
\hline
{\em flag\-\_\-nofft} & flag to do product without using fft \\
\hline
\end{DoxyParams}


Definition at line 659 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!stmm\-\_\-main@{stmm\-\_\-main}}
\index{stmm\-\_\-main@{stmm\-\_\-main}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{stmm\-\_\-main}]{\setlength{\rightskip}{0pt plus 5cm}int stmm\-\_\-main (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{n, }
\item[{int}]{m, }
\item[{int}]{id0, }
\item[{int}]{l, }
\item[{double $\ast$}]{T, }
\item[{fftw\-\_\-complex $\ast$}]{T\-\_\-fft, }
\item[{int}]{lambda, }
\item[{fftw\-\_\-complex $\ast$}]{V\-\_\-fft, }
\item[{double $\ast$}]{V\-\_\-rfft, }
\item[{fftw\-\_\-plan}]{plan\-\_\-f, }
\item[{fftw\-\_\-plan}]{plan\-\_\-b, }
\item[{int}]{blocksize, }
\item[{int}]{nfft, }
\item[{Flag}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}\label{toeplitz_8c_ace7322011cd24b469e9b5d530e8a71ba}


Performs the product of a Toeplitz matrix by a general matrix using the sliding window algorithm with optimize reshaping. (an I\-N\-T\-E\-R\-N\-A\-L routine) 

The input matrix is formatted into an optimized matrix depending on the block size and the number of simultaneous ffts (defined with the variable nfft). The obtained number of columns represent the number of vectors F\-F\-Ts of which are computed simulatenously. The multiplication is then performed block-\/by-\/block with the chosen block size using the core routine. The parameters are \-: 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em n} & number of rows of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em id0} & first index of V \\
\hline
{\em l} & length of V \\
\hline
{\em T} & Toeplitz matrix data composed of the non-\/zero entries of his first row \\
\hline
{\em T\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em lambda} & Toeplitz band width \\
\hline
{\em V\-\_\-fft} & complex array used for F\-F\-Ts \\
\hline
{\em V\-\_\-rfft} & real array used for F\-F\-Ts \\
\hline
{\em plan\-\_\-f} & fftw plan forward (r2c) \\
\hline
{\em plan\-\_\-b} & fftw plan backward (c2r) \\
\hline
{\em blocksize} & block size \\
\hline
{\em nfft} & number of simultaneous F\-T\-Ts \\
\hline
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line 803 of file toeplitz.\-c.



\subsection{Variable Documentation}
\index{toeplitz.\-c@{toeplitz.\-c}!V\-E\-R\-B\-O\-S\-E@{V\-E\-R\-B\-O\-S\-E}}
\index{V\-E\-R\-B\-O\-S\-E@{V\-E\-R\-B\-O\-S\-E}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{V\-E\-R\-B\-O\-S\-E}]{\setlength{\rightskip}{0pt plus 5cm}int V\-E\-R\-B\-O\-S\-E}\label{toeplitz_8c_ab848ce91ba14d3dc5c87d0b42f3a1c0d}


Verbose mode. 

Prints some informative messages during the computation. 

Definition at line 78 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!V\-E\-R\-B\-O\-S\-E\-\_\-\-F\-I\-R\-S\-T\-I\-N\-I\-T@{V\-E\-R\-B\-O\-S\-E\-\_\-\-F\-I\-R\-S\-T\-I\-N\-I\-T}}
\index{V\-E\-R\-B\-O\-S\-E\-\_\-\-F\-I\-R\-S\-T\-I\-N\-I\-T@{V\-E\-R\-B\-O\-S\-E\-\_\-\-F\-I\-R\-S\-T\-I\-N\-I\-T}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{V\-E\-R\-B\-O\-S\-E\-\_\-\-F\-I\-R\-S\-T\-I\-N\-I\-T}]{\setlength{\rightskip}{0pt plus 5cm}int V\-E\-R\-B\-O\-S\-E\-\_\-\-F\-I\-R\-S\-T\-I\-N\-I\-T = 1}\label{toeplitz_8c_a005f790383498397d0fdad1513881e3f}


Definition at line 79 of file toeplitz.\-c.

\index{toeplitz.\-c@{toeplitz.\-c}!P\-R\-I\-N\-T\-\_\-\-R\-A\-N\-K@{P\-R\-I\-N\-T\-\_\-\-R\-A\-N\-K}}
\index{P\-R\-I\-N\-T\-\_\-\-R\-A\-N\-K@{P\-R\-I\-N\-T\-\_\-\-R\-A\-N\-K}!toeplitz.c@{toeplitz.\-c}}
\subsubsection[{P\-R\-I\-N\-T\-\_\-\-R\-A\-N\-K}]{\setlength{\rightskip}{0pt plus 5cm}int P\-R\-I\-N\-T\-\_\-\-R\-A\-N\-K = -\/1}\label{toeplitz_8c_a300d52d9923297872ffb24962a0f0ce6}


Definition at line 82 of file toeplitz.\-c.

