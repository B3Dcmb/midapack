<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MIDAPACK - MIcrowave Data Analysis PACKage: toeplitz.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoANR-MIDAS09_quarter.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MIDAPACK - MIcrowave Data Analysis PACKage
   &#160;<span id="projectnumber">1.0beta</span>
   </div>
   <div id="projectbrief">Parallel software tools for high performance CMB DA analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('toeplitz_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">toeplitz.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains the main part of the sequential routines for Toeplitz algebra.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;toeplitz.h&quot;</code><br/>
</div>
<p><a href="toeplitz_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a24331a8efb6e0b77df7c645ef45b2830"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a24331a8efb6e0b77df7c645ef45b2830">print_error_message</a> (int error_number, char const *file, int line)</td></tr>
<tr class="memdesc:a24331a8efb6e0b77df7c645ef45b2830"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints error message corresponding to an error number.  <a href="#a24331a8efb6e0b77df7c645ef45b2830"></a><br/></td></tr>
<tr class="memitem:a186fc8d8825da293e94de77b77d01fba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a186fc8d8825da293e94de77b77d01fba">define_blocksize</a> (int n, int lambda, int bs_flag, int fixed_bs)</td></tr>
<tr class="memdesc:a186fc8d8825da293e94de77b77d01fba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines an optimal size of the block used in the sliding windows algorithm.  <a href="#a186fc8d8825da293e94de77b77d01fba"></a><br/></td></tr>
<tr class="memitem:a4c2846ca9f67faae5746325d1ec63aac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a4c2846ca9f67faae5746325d1ec63aac">define_nfft</a> (int n_thread, int flag_nfft, int fixed_nfft)</td></tr>
<tr class="memdesc:a4c2846ca9f67faae5746325d1ec63aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the number of simultaneous ffts for the Toeplitz matrix product computation.  <a href="#a4c2846ca9f67faae5746325d1ec63aac"></a><br/></td></tr>
<tr class="memitem:a7f4e77d71f2c6f2caf652bab7520e3f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a7f4e77d71f2c6f2caf652bab7520e3f4">tpltz_init</a> (int n, int lambda, int *nfft, int *blocksize, fftw_complex **T_fft, double *T, fftw_complex **V_fft, double **V_rfft, fftw_plan *plan_f, fftw_plan *plan_b, Flag flag_stgy)</td></tr>
<tr class="memdesc:a7f4e77d71f2c6f2caf652bab7520e3f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a block size and initializes all fftw arrays and plans needed for the computation.  <a href="#a7f4e77d71f2c6f2caf652bab7520e3f4"></a><br/></td></tr>
<tr class="memitem:ae3d694bcffacaf24706f0586a223538e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#ae3d694bcffacaf24706f0586a223538e">fftw_init_omp_threads</a> (int fftw_n_thread)</td></tr>
<tr class="memdesc:ae3d694bcffacaf24706f0586a223538e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize omp threads for fftw plans.  <a href="#ae3d694bcffacaf24706f0586a223538e"></a><br/></td></tr>
<tr class="memitem:a1a6106fbaa68aab85595935252299097"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a1a6106fbaa68aab85595935252299097">rhs_init_fftw</a> (int *nfft, int fft_size, fftw_complex **V_fft, double **V_rfft, fftw_plan *plan_f, fftw_plan *plan_b, int fftw_flag)</td></tr>
<tr class="memdesc:a1a6106fbaa68aab85595935252299097"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes fftw array and plan for the right hand side, general matrix V.  <a href="#a1a6106fbaa68aab85595935252299097"></a><br/></td></tr>
<tr class="memitem:a6c68921dafc6dc184d335a59df68e5f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a6c68921dafc6dc184d335a59df68e5f7">circ_init_fftw</a> (double *T, int fft_size, int lambda, fftw_complex **T_fft)</td></tr>
<tr class="memdesc:a6c68921dafc6dc184d335a59df68e5f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes fftw array and plan for the circulant matrix T_circ obtained from T.  <a href="#a6c68921dafc6dc184d335a59df68e5f7"></a><br/></td></tr>
<tr class="memitem:ac7ac0ee5f6eaee6846814b131671f6e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#ac7ac0ee5f6eaee6846814b131671f6e8">tpltz_cleanup</a> (fftw_complex **T_fft, fftw_complex **V_fft, double **V_rfft, fftw_plan *plan_f, fftw_plan *plan_b)</td></tr>
<tr class="memdesc:ac7ac0ee5f6eaee6846814b131671f6e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleans fftw workspace used in the Toeplitz matrix matrix product's computation.  <a href="#ac7ac0ee5f6eaee6846814b131671f6e8"></a><br/></td></tr>
<tr class="memitem:a7dddc7df6f787d6aa92dfc25e9d0465a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a7dddc7df6f787d6aa92dfc25e9d0465a">copy_block</a> (int ninrow, int nincol, double *Vin, int noutrow, int noutcol, double *Vout, int inrow, int incol, int nblockrow, int nblockcol, int outrow, int outcol, double norm, int set_zero_flag)</td></tr>
<tr class="memdesc:a7dddc7df6f787d6aa92dfc25e9d0465a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies (and potentially reshapes) a selected block of the input matrix to a specified position of the output matrix.  <a href="#a7dddc7df6f787d6aa92dfc25e9d0465a"></a><br/></td></tr>
<tr class="memitem:a2c399885221722e98f72206ddce8d0d3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a2c399885221722e98f72206ddce8d0d3">scmm_direct</a> (int fft_size, int nfft, fftw_complex *C_fft, int ncol, double *V_rfft, double **CV, fftw_complex *V_fft, fftw_plan plan_f_V, fftw_plan plan_b_CV)</td></tr>
<tr class="memdesc:a2c399885221722e98f72206ddce8d0d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the product of a circulant matrix C_fft by a matrix V_rfft using fftw plans.  <a href="#a2c399885221722e98f72206ddce8d0d3"></a><br/></td></tr>
<tr class="memitem:ab8839f416f8f8165b31a5363c405428d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#ab8839f416f8f8165b31a5363c405428d">scmm_basic</a> (double **V, int blocksize, int m, fftw_complex *C_fft, double **CV, fftw_complex *V_fft, double *V_rfft, int nfft, fftw_plan plan_f_V, fftw_plan plan_b_CV)</td></tr>
<tr class="memdesc:ab8839f416f8f8165b31a5363c405428d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the product of a circulant matrix by a matrix using FFT's (an INTERNAL routine)  <a href="#ab8839f416f8f8165b31a5363c405428d"></a><br/></td></tr>
<tr class="memitem:a2731f1bbfce2d47c4cc3381150470da4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a2731f1bbfce2d47c4cc3381150470da4">stmm_core</a> (double **V, int n, int m, double *T, fftw_complex *T_fft, int blocksize, int lambda, fftw_complex *V_fft, double *V_rfft, int nfft, fftw_plan plan_f, fftw_plan plan_b, int flag_offset, int flag_nofft)</td></tr>
<tr class="memdesc:a2731f1bbfce2d47c4cc3381150470da4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. (an INTERNAL routine)  <a href="#a2731f1bbfce2d47c4cc3381150470da4"></a><br/></td></tr>
<tr class="memitem:ace7322011cd24b469e9b5d530e8a71ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#ace7322011cd24b469e9b5d530e8a71ba">stmm_main</a> (double **V, int n, int m, int id0, int l, double *T, fftw_complex *T_fft, int lambda, fftw_complex *V_fft, double *V_rfft, fftw_plan plan_f, fftw_plan plan_b, int blocksize, int nfft, Flag flag_stgy)</td></tr>
<tr class="memdesc:ace7322011cd24b469e9b5d530e8a71ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the product of a Toeplitz matrix by a general matrix using the sliding window algorithm with optimize reshaping. (an INTERNAL routine)  <a href="#ace7322011cd24b469e9b5d530e8a71ba"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab848ce91ba14d3dc5c87d0b42f3a1c0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#ab848ce91ba14d3dc5c87d0b42f3a1c0d">VERBOSE</a></td></tr>
<tr class="memdesc:ab848ce91ba14d3dc5c87d0b42f3a1c0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verbose mode.  <a href="#ab848ce91ba14d3dc5c87d0b42f3a1c0d"></a><br/></td></tr>
<tr class="memitem:a005f790383498397d0fdad1513881e3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a005f790383498397d0fdad1513881e3f">VERBOSE_FIRSTINIT</a> = 1</td></tr>
<tr class="memitem:a300d52d9923297872ffb24962a0f0ce6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="toeplitz_8c.html#a300d52d9923297872ffb24962a0f0ce6">PRINT_RANK</a> = -1</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Contains the main part of the sequential routines for Toeplitz algebra. </p>
<p>version 1.2b, November 2012 </p>
<dl class="section author"><dt>Author:</dt><dd>Frederic Dauvergne, Maude Le Jeune, Antoine Rogier, Radek Stompor</dd></dl>
<p>Project: Midapack library, ANR MIDAS'09 - Toeplitz Algebra module Purpose: Provide Toeplitz algebra tools suitable for Cosmic Microwave Background (CMB) data analysis.</p>
<dl class="section note"><dt>Note:</dt><dd>Copyright (c) 2010-2012 APC CNRS Université Paris Diderot </dd>
<dd>
</dd>
<dd>
This program is free software; you can redistribute it and/or modify it under the terms </dd>
<dd>
of the GNU Lesser General Public License as published by the Free Software Foundation; </dd>
<dd>
either version 3 of the License, or (at your option) any later version. This program is </dd>
<dd>
distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even </dd>
<dd>
the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU </dd>
<dd>
Lesser General Public License for more details. </dd>
<dd>
</dd>
<dd>
You should have received a copy of the GNU Lesser General Public License along with this </dd>
<dd>
program; if not, see <a href="http://www.gnu.org/licenses/lgpl.html">http://www.gnu.org/licenses/lgpl.html</a> </dd>
<dd>
</dd>
<dd>
For more information about ANR MIDAS'09 project see : </dd>
<dd>
<a href="http://www.apc.univ-paris7.fr/APC_CS/Recherche/Adamis/MIDAS09/index.html">http://www.apc.univ-paris7.fr/APC_CS/Recherche/Adamis/MIDAS09/index.html</a> </dd>
<dd>
</dd>
<dd>
ACKNOWLEDGMENT: This work has been supported in part by the French National Research </dd>
<dd>
Agency (ANR) through COSINUS program (project MIDAS no. ANR-09-COSI-009).</dd></dl>
<p>Log: toeplitz*.c</p>
<p>Revision 1.0b 2012/05/07 Frederic Dauvergne (APC) Official release 1.0beta. The first installement of the library is the Toeplitz algebra module.</p>
<p>Revision 1.1b 2012/07/- Frederic Dauvergne (APC)</p>
<ul>
<li>mpi_stbmm allows now rowi-wise order per process datas and no-blocking communications.</li>
<li>OMP improvment for optimal cpu time.</li>
<li>bug fixed for OMP in the stmm_basic routine.</li>
<li>distcorrmin is used to communicate only lambda-1 datas when it is needed.</li>
<li>new reshaping routines using transformation functions in stmm. Thus, only one copy at most is needed.</li>
<li>tpltz_init improvement using define_nfft and define_blocksize routines.</li>
<li>add Block struture to define each Toeplitz block.</li>
<li>add Flag structure and preprocessing parameters to define the computational strategy. All the flag parameters are then available directly from the API.</li>
</ul>
<p>Revision 1.2b 2012/11/30 Frederic Dauvergne (APC)</p>
<ul>
<li>extend the mpi product routine to rowwise order data distribution. This is now allowing tree kinds of distribution.</li>
<li>add int64 for some variables to extend the global volume of data you can use.</li>
<li>Openmp improvments.</li>
<li>Add <a class="el" href="toeplitz__wizard_8c.html" title="easy-to-use and &quot;all-in-one&quot; wizard routines for the Toeplitz module">toeplitz_wizard.c</a>, which contains a set of easy to use routines with defined structures. </li>
</ul>

<p>Definition in file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a24331a8efb6e0b77df7c645ef45b2830"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int print_error_message </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>error_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints error message corresponding to an error number. </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">error_number</td><td>error number </td></tr>
    <tr><td class="paramname">file</td><td>file name </td></tr>
    <tr><td class="paramname">line</td><td>line number </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00093">93</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a186fc8d8825da293e94de77b77d01fba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int define_blocksize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bs_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fixed_bs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines an optimal size of the block used in the sliding windows algorithm. </p>
<p>The optimal block size is computed as the minimum power of two above 3*lambda, i.e. the smallest value equal to 2^x, where x is an integer, and above 3*lambda. If bs_flag is set to one, a different formula is used to compute the optimal block size (see MADmap: A MASSIVELY PARALLEL MAXIMUM LIKELIHOOD COSMIC MICROWAVE BACKGROUND MAP-MAKER, C. M. Cantalupo, J. D. Borrill, A. H. Jaffe, T. S. Kisner, and R. Stompor, The Astrophysical Journal Supplement Series, 187:212–227, 2010 March). To avoid using block size much bigger than the matrix, the block size is set to 3*lambda when his previous computed size is bigger than the matrix size n. This case append mostly for small matrix compared to his bandwith. </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>matrix row dimension </td></tr>
    <tr><td class="paramname">lambda</td><td>half bandwidth of the Toeplitz matrix </td></tr>
    <tr><td class="paramname">bs_flag</td><td>flag to use a different formula for optimal block size computation </td></tr>
    <tr><td class="paramname">fixed_bs</td><td>fixed blocksize value if needed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00130">130</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4c2846ca9f67faae5746325d1ec63aac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int define_nfft </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fixed_nfft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the number of simultaneous ffts for the Toeplitz matrix product computation. </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">n_thread</td><td>number of omp threads </td></tr>
    <tr><td class="paramname">flag_nfft</td><td>flag to set the strategy to define nfft </td></tr>
    <tr><td class="paramname">fixed_nfft</td><td>fixed nfft value if nedeed (used for the case where flag_nfft=1) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00220">220</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7f4e77d71f2c6f2caf652bab7520e3f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tpltz_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex **&#160;</td>
          <td class="paramname"><em>T_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex **&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>plan_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>plan_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Flag&#160;</td>
          <td class="paramname"><em>flag_stgy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets a block size and initializes all fftw arrays and plans needed for the computation. </p>
<p>Initializes the fftw arrays and plans is necessary before any computation of the Toeplitz matrix matrix product. Use tpltz_cleanup afterwards. </p>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="toeplitz_8c.html#ac7ac0ee5f6eaee6846814b131671f6e8" title="Cleans fftw workspace used in the Toeplitz matrix matrix product&#39;s computation.">tpltz_cleanup</a> </dd></dl>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>row size of the matrix used for later product </td></tr>
    <tr><td class="paramname">lambda</td><td>Toeplitz band width </td></tr>
    <tr><td class="paramname">nfft</td><td>maximum number of FFTs you want to compute at the same time </td></tr>
    <tr><td class="paramname">blocksize</td><td>optimal block size used in the sliding window algorithm to compute an optimize value) </td></tr>
    <tr><td class="paramname">T_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">T</td><td>Toeplitz matrix </td></tr>
    <tr><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramname">plan_f</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramname">plan_b</td><td>fftw plan backward (c2r) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00257">257</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae3d694bcffacaf24706f0586a223538e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fftw_init_omp_threads </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fftw_n_thread</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize omp threads for fftw plans. </p>
<p>Initialize omp threads for fftw plans. The number of threads used for ffts (define by the variable n_thread) is read from OMP_NUM_THREAD environment variable. fftw multithreaded option is controlled by fftw_MULTITHREADING macro. </p>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00333">333</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1a6106fbaa68aab85595935252299097"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rhs_init_fftw </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex **&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>plan_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>plan_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fftw_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes fftw array and plan for the right hand side, general matrix V. </p>
<p>Initialize fftw array and plan for the right hand side matrix V. </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">nfft</td><td>maximum number of FFTs you want to compute at the same time </td></tr>
    <tr><td class="paramname">fft_size</td><td>effective FFT size for the general matrix V (usually equal to blocksize) </td></tr>
    <tr><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramname">plan_f</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramname">plan_b</td><td>fftw plan backward (c2r) </td></tr>
    <tr><td class="paramname">fftw_flag</td><td>fftw plan allocation flag </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00365">365</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6c68921dafc6dc184d335a59df68e5f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int circ_init_fftw </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex **&#160;</td>
          <td class="paramname"><em>T_fft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes fftw array and plan for the circulant matrix T_circ obtained from T. </p>
<p>Builds the circulant matrix T_circ from T and initilizes its fftw arrays and plans. Use tpltz_cleanup afterwards. </p>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="toeplitz_8c.html#ac7ac0ee5f6eaee6846814b131671f6e8" title="Cleans fftw workspace used in the Toeplitz matrix matrix product&#39;s computation.">tpltz_cleanup</a> </dd></dl>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">T</td><td>Toeplitz matrix. </td></tr>
    <tr><td class="paramname">fft_size</td><td>effective FFT size for the circulant matrix (usually equal to blocksize) </td></tr>
    <tr><td class="paramname">lambda</td><td>Toeplitz band width. </td></tr>
    <tr><td class="paramname">T_fft</td><td>complex array used for FFTs. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00392">392</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac7ac0ee5f6eaee6846814b131671f6e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tpltz_cleanup </td>
          <td>(</td>
          <td class="paramtype">fftw_complex **&#160;</td>
          <td class="paramname"><em>T_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex **&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>plan_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan *&#160;</td>
          <td class="paramname"><em>plan_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cleans fftw workspace used in the Toeplitz matrix matrix product's computation. </p>
<p>Destroy fftw plans, free memory and reset fftw workspace. </p>
<dl class="section see"><dt>See also:</dt><dd><a class="el" href="toeplitz_8c.html#a7f4e77d71f2c6f2caf652bab7520e3f4" title="Sets a block size and initializes all fftw arrays and plans needed for the computation.">tpltz_init</a> </dd></dl>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">T_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramname">plan_f</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramname">plan_b</td><td>fftw plan backward (c2r) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00435">435</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7dddc7df6f787d6aa92dfc25e9d0465a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int copy_block </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ninrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nincol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Vin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>noutrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>noutcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Vout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>inrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>incol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nblockrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nblockcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outrow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set_zero_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies (and potentially reshapes) a selected block of the input matrix to a specified position of the output matrix. </p>
<p>Copy a matrix block of a size nblockrow x nblockcol from the input matrix Vin (size ninrow x nincol) starting with the element (inrow, incol) to the output matrix Vout (size notrow x noutcol) starting with the element (outrow, outcol) after multiplying by norm. If the output matrix is larger than the block the extra elements are either left as they were on the input or zeroed if zero_flag is set to 1. If the block to be copied is larger than either the input or the output matrix an error occurs. </p>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00459">459</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2c399885221722e98f72206ddce8d0d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scmm_direct </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>C_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>CV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_f_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_b_CV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the product of a circulant matrix C_fft by a matrix V_rfft using fftw plans. </p>
<p>Performs the product of a circulant matrix C_fft by a matrix V_rfft using fftw plans: forward - plan_f_V; and backward - plan_b_CV. C_fft is a Fourier (complex representation of the circulant matrix) of length fft_size/2+1; V_rfft is a matrix with ncol columns and fft_size rows; V_fft is a workspace of fft_size/2+1 complex numbers as required by the backward FFT (plan_b_CV); CV is the output matrix of the same size as the input V_rfft one. The FFTs transform ncol vectors simultanously. </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">fft_size</td><td>row dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nfft</td><td>number of simultaneous FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">C_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ncol</td><td>column dimension </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CV</td><td>product of the circulant matrix C_fft by the matrix V_rfft </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plan_f_V</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plan_b_CV</td><td>fftw plan backward (c2r) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00509">509</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab8839f416f8f8165b31a5363c405428d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scmm_basic </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>C_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>CV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_f_V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_b_CV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the product of a circulant matrix by a matrix using FFT's (an INTERNAL routine) </p>
<p>This routine multiplies a circulant matrix, represented by C_fft, by a general matrix V, and stores the output as a matrix CV. In addition the routine requires two workspace objects, V_fft and V_rfft, to be allocated prior to a call to it as well as two fftw plans: one forward (plan_f_V), and one backward (plan_b_TV). The sizes of the input general matrix V and the ouput CV are given by blocksize rows and m columns. They are stored as a vector in the column-wise order. The circulant matrix, which is assumed to be band-diagonal with a band-width lambda, is represented by a Fourier transform with its coefficients stored in a vector C_fft (length blocksize). blocksize also defines the size of the FFTs, which will be performed and therefore this is the value which has to be used while creating the fftw plans and allocating the workspaces. The latter are given as: nfft*(blocksize/2+1) for V_fft and nfft*blocksize for V_rfft. The fftw plans should correspond to doing the transforms of nfft vectors simultaneously. Typically, the parameters of this routine are fixed by a preceding call to Toeplitz_init(). The parameters are : </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">V</td><td>matrix (with the convention V(i,j)=V[i+j*n]) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">blocksize</td><td>row dimension of V </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">m</td><td>column dimension of V </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">C_fft</td><td>complex array used for FFTs (FFT of the Toeplitz matrix) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CV</td><td>product of the circulant matrix C_fft by the matrix V_rfft </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nfft</td><td>number of simultaneous FFTs </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plan_f_V</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plan_b_CV</td><td>fftw plan backward (c2r) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00587">587</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2731f1bbfce2d47c4cc3381150470da4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stmm_core </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>T_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_nofft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the stand alone product of a Toeplitz matrix by a matrix using the sliding window algorithm. (an INTERNAL routine) </p>
<p>The product is performed block-by-block with a defined block size or a computed optimized block size that reflects a trade off between cost of a single FFT of a length block_size and a number of blocks needed to perform the mutiplicaton. The latter determines how many spurious values are computed extra due to overlaps between the blocks. Use flag_offset=0 for "classic" algorithm and flag_offset=1 to put an offset to avoid the first and last lambdas terms. Usefull when a reshaping was done before with optimal column for a nfft. Better be inside the arguments of the routine. The parameters are: </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">V</td><td><b></b>[input] data matrix (with the convention V(i,j)=V[i+j*n]) ; <b></b>[out] result of the product TV </td></tr>
    <tr><td class="paramname">n</td><td>number of rows of V </td></tr>
    <tr><td class="paramname">m</td><td>number of columns of V </td></tr>
    <tr><td class="paramname">T</td><td>Toeplitz matrix data composed of the non-zero entries of his first row </td></tr>
    <tr><td class="paramname">T_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">blocksize</td><td>block size used in the sliding window algorithm </td></tr>
    <tr><td class="paramname">lambda</td><td>Toeplitz band width </td></tr>
    <tr><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramname">nfft</td><td>number of simultaneous FFTs </td></tr>
    <tr><td class="paramname">plan_f</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramname">plan_b</td><td>fftw plan backward (c2r) </td></tr>
    <tr><td class="paramname">flag_offset</td><td>flag to avoid extra 2*lambda padding to zeros on the edges </td></tr>
    <tr><td class="paramname">flag_nofft</td><td>flag to do product without using fft </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00659">659</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="ace7322011cd24b469e9b5d530e8a71ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stmm_main </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>T_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>V_fft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>V_rfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan&#160;</td>
          <td class="paramname"><em>plan_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Flag&#160;</td>
          <td class="paramname"><em>flag_stgy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the product of a Toeplitz matrix by a general matrix using the sliding window algorithm with optimize reshaping. (an INTERNAL routine) </p>
<p>The input matrix is formatted into an optimized matrix depending on the block size and the number of simultaneous ffts (defined with the variable nfft). The obtained number of columns represent the number of vectors FFTs of which are computed simulatenously. The multiplication is then performed block-by-block with the chosen block size using the core routine. The parameters are : </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">V</td><td><b></b>[input] data matrix (with the convention V(i,j)=V[i+j*n]) ; <b></b>[out] result of the product TV </td></tr>
    <tr><td class="paramname">n</td><td>number of rows of V </td></tr>
    <tr><td class="paramname">m</td><td>number of columns of V </td></tr>
    <tr><td class="paramname">id0</td><td>first index of V </td></tr>
    <tr><td class="paramname">l</td><td>length of V </td></tr>
    <tr><td class="paramname">T</td><td>Toeplitz matrix data composed of the non-zero entries of his first row </td></tr>
    <tr><td class="paramname">T_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">lambda</td><td>Toeplitz band width </td></tr>
    <tr><td class="paramname">V_fft</td><td>complex array used for FFTs </td></tr>
    <tr><td class="paramname">V_rfft</td><td>real array used for FFTs </td></tr>
    <tr><td class="paramname">plan_f</td><td>fftw plan forward (r2c) </td></tr>
    <tr><td class="paramname">plan_b</td><td>fftw plan backward (c2r) </td></tr>
    <tr><td class="paramname">blocksize</td><td>block size </td></tr>
    <tr><td class="paramname">nfft</td><td>number of simultaneous FTTs </td></tr>
    <tr><td class="paramname">flag_stgy</td><td>flag strategy for the product computation </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00803">803</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ab848ce91ba14d3dc5c87d0b42f3a1c0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VERBOSE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verbose mode. </p>
<p>Prints some informative messages during the computation. </p>

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00078">78</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a005f790383498397d0fdad1513881e3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VERBOSE_FIRSTINIT = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00079">79</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
<a class="anchor" id="a300d52d9923297872ffb24962a0f0ce6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PRINT_RANK = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="toeplitz_8c_source.html#l00082">82</a> of file <a class="el" href="toeplitz_8c_source.html">toeplitz.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_047e6a79ec3005ff33af710a2117944f.html">toeplitz</a></li><li class="navelem"><a class="el" href="toeplitz_8c.html">toeplitz.c</a></li>
    <li class="footer">Generated on Fri Jul 12 2013 10:34:54 for MIDAPACK - MIcrowave Data Analysis PACKage by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.1 </li>
  </ul>
</div>
</body>
</html>
