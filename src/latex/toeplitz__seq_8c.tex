\section{toeplitz\-\_\-seq.\-c File Reference}
\label{toeplitz__seq_8c}\index{toeplitz\-\_\-seq.\-c@{toeplitz\-\_\-seq.\-c}}


Contains sequential/open\-M\-P routines for Toeplitz algebra.  


{\ttfamily \#include \char`\"{}toeplitz.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{toeplitz__seq_8c_ab2face64bf4e429b38b3ae1a6701cc78}{stmm} (double $\ast$$\ast$V, int n, int m, double $\ast$T, int lambda, Flag flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Perform the product of a Toeplitz matrix by a general matrix using the sliding window algorithm. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz__seq_8c_ab51a5dfa887d47b4ce627eb0e01a2e0a}{stbmm} (double $\ast$$\ast$V, int nrow, int m\-\_\-cw, int m\-\_\-rw, Block $\ast$tpltzblocks, int nb\-\_\-blocks, int64\-\_\-t idp, int local\-\_\-\-V\-\_\-size, Flag flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Performs the multiplication of a symmetric, Toeplitz block-\/diagonal matrix, T, by an arbitrary matrix, V, distributed over processes in the generalized column-\/wise way. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz__seq_8c_a4cd10fd194db5a77c0366cddeda596ae}{gstbmm} (double $\ast$$\ast$V, int nrow, int m\-\_\-cw, int m\-\_\-rw, Block $\ast$tpltzblocks, int nb\-\_\-blocks, int64\-\_\-t idp, int local\-\_\-\-V\-\_\-size, int64\-\_\-t $\ast$id0gap, int $\ast$lgap, int ngap, Flag flag\-\_\-stgy)
\begin{DoxyCompactList}\small\item\em Performs the multiplication of a symmetric, Toeplitz block-\/diagonal matrix with gaps, T, by an arbitrary matrix, V, distributed over processes. \end{DoxyCompactList}\item 
int \hyperlink{toeplitz__seq_8c_a5aa00da67c3344b6d0b9d3fdf24d5a1c}{gstbmm0} (double $\ast$$\ast$V, int nrow, int m, int m\-\_\-rowwise, Block $\ast$tpltzblocks, int nb\-\_\-blocks\-\_\-local, int nb\-\_\-blocks\-\_\-all, int id0p, int local\-\_\-\-V\-\_\-size, int64\-\_\-t $\ast$id0gap, int $\ast$lgap, int ngap, Flag flag\-\_\-stgy)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Contains sequential/open\-M\-P routines for Toeplitz algebra. version 1.\-1b, July 2012 \begin{DoxyAuthor}{Author}
Frederic Dauvergne
\end{DoxyAuthor}
Project\-: Midapack library, A\-N\-R M\-I\-D\-A\-S'09 -\/ Toeplitz Algebra module Purpose\-: Provide Toeplitz algebra tools suitable for Cosmic Microwave Background (C\-M\-B) data analysis.

\begin{DoxyNote}{Note}
Copyright (c) 2010-\/2012 A\-P\-C C\-N\-R\-S Université Paris Diderot 



This program is free software; you can redistribute it and/or modify it under the terms 

of the G\-N\-U Lesser General Public License as published by the Free Software Foundation; 

either version 3 of the License, or (at your option) any later version. This program is 

distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even 

the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U 

Lesser General Public License for more details. 



You should have received a copy of the G\-N\-U Lesser General Public License along with this 

program; if not, see \href{http://www.gnu.org/licenses/lgpl.html}{\tt http\-://www.\-gnu.\-org/licenses/lgpl.\-html} 

For more information about A\-N\-R M\-I\-D\-A\-S'09 project see \-: 

\href{http://www.apc.univ-paris7.fr/APC_CS/Recherche/Adamis/MIDAS09/index.html}{\tt http\-://www.\-apc.\-univ-\/paris7.\-fr/\-A\-P\-C\-\_\-\-C\-S/\-Recherche/\-Adamis/\-M\-I\-D\-A\-S09/index.\-html} 

A\-C\-K\-N\-O\-W\-L\-E\-D\-G\-M\-E\-N\-T\-: This work has been supported in part by the French National Research 

Agency (A\-N\-R) through C\-O\-S\-I\-N\-U\-S program (project M\-I\-D\-A\-S no. A\-N\-R-\/09-\/\-C\-O\-S\-I-\/009).
\end{DoxyNote}
Log\-: toeplitz$\ast$.c

Revision 1.\-0b 2012/05/07 Frederic Dauvergne (A\-P\-C) Official release 1.\-0beta. The first installement of the library is the Toeplitz algebra module.

Revision 1.\-1b 2012/07/-\/ Frederic Dauvergne (A\-P\-C)
\begin{DoxyItemize}
\item mpi\-\_\-stbmm allows now rowi-\/wise order per process datas and no-\/blocking communications.
\item O\-M\-P improvment for optimal cpu time.
\item bug fixed for O\-M\-P in the stmm\-\_\-basic routine.
\item distcorrmin is used to communicate only lambda-\/1 datas when it is needed.
\item new reshaping routines using transformation functions in stmm. Thus, only one copy at most is needed.
\item tpltz\-\_\-init improvement using define\-\_\-nfft and define\-\_\-blocksize routines.
\item add Block struture to define each Toeplitz block.
\item add Flag structure and preprocessing parameters to define the computational strategy. All the flag parameters are then available directly from the A\-P\-I.
\end{DoxyItemize}

version 1.\-1b, July 2012 Project\-: Midapack library, A\-N\-R M\-I\-D\-A\-S'09 -\/ Toeplitz Algebra module Purpose\-: Provide Toeplitz algebra tools suitable for Cosmic Microwave Background (C\-M\-B) data analysis.

\begin{DoxyAuthor}{Author}
Frederic Dauvergne, Pierre Cargemel, Maude Le Jeune, Antoine Rogier, Radek Stompor (A\-P\-C, Paris)
\end{DoxyAuthor}
\begin{DoxyNote}{Note}
Copyright (c) 2010-\/2012 A\-P\-C C\-N\-R\-S Université Paris Diderot 



This program is free software; you can redistribute it and/or modify it under the terms of the G\-N\-U Lesser General Public License as published by the Free Software Foundation; either version 3 of the License, or 

(at your option) any later version. This program is distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of 

M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U Lesser General Public License for more details. 



You should have received a copy of the G\-N\-U General Public License along with this program; if not, see \href{http://www.gnu.org/licenses/lgpl.html}{\tt http\-://www.\-gnu.\-org/licenses/lgpl.\-html}

For more information about A\-N\-R M\-I\-D\-A\-S'09 project see \href{http://www.apc.univ-paris7.fr/APC_CS/Recherche/Adamis/MIDAS09/index.html}{\tt http\-://www.\-apc.\-univ-\/paris7.\-fr/\-A\-P\-C\-\_\-\-C\-S/\-Recherche/\-Adamis/\-M\-I\-D\-A\-S09/index.\-html}

A\-C\-K\-N\-O\-W\-L\-E\-D\-G\-M\-E\-N\-T\-: This work has been supported in part by the French National Research Agency (A\-N\-R) through C\-O\-S\-I\-N\-U\-S program (project M\-I\-D\-A\-S no. A\-N\-R-\/09-\/\-C\-O\-S\-I-\/009).
\end{DoxyNote}
Log\-: toeplitz$\ast$.c

Revision 1.\-0b 2012/05/07 Frederic Dauvergne (A\-P\-C) Official release 1.\-0beta. The first installement of the library is the Toeplitz algebra module.

Revision 1.\-1b 2012/07/-\/ Frederic Dauvergne (A\-P\-C)
\begin{DoxyItemize}
\item mpi\-\_\-stbmm allows now rowi-\/wise order per process datas and no-\/blocking communications.
\item O\-M\-P improvment for optimal cpu time.
\item bug fixed for O\-M\-P in the stmm\-\_\-basic routine.
\item distcorrmin is used to communicate only lambda-\/1 datas when it is needed.
\item new reshaping routines using transformation functions in stmm. Thus, only one copy at most is needed.
\item tpltz\-\_\-init improvement using define\-\_\-nfft and define\-\_\-blocksize routines.
\item add Block struture to define each Toeplitz block.
\item add Flag structure and preprocessing parameters to define the computational strategy. 
\end{DoxyItemize}

Definition in file \hyperlink{toeplitz__seq_8c_source}{toeplitz\-\_\-seq.\-c}.



\subsection{Function Documentation}
\index{toeplitz\-\_\-seq.\-c@{toeplitz\-\_\-seq.\-c}!stmm@{stmm}}
\index{stmm@{stmm}!toeplitz_seq.c@{toeplitz\-\_\-seq.\-c}}
\subsubsection[{stmm}]{\setlength{\rightskip}{0pt plus 5cm}int stmm (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{n, }
\item[{int}]{m, }
\item[{double $\ast$}]{T, }
\item[{int}]{lambda, }
\item[{Flag}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}\label{toeplitz__seq_8c_ab2face64bf4e429b38b3ae1a6701cc78}


Perform the product of a Toeplitz matrix by a general matrix using the sliding window algorithm. 

This is a simplifed call of the sequential product including initialization and cleaning. This use the flag parameters to set the comutational options. 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em n} & number of rows of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em m} & number of columns of V \\
\hline
{\em T} & Toeplitz matrix data composed of the non-\/zero entries of his first row \\
\hline
{\em lambda} & number of non-\/zero in the first row of the Toeplitz and size of T \\
\hline
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line 72 of file toeplitz\-\_\-seq.\-c.

\index{toeplitz\-\_\-seq.\-c@{toeplitz\-\_\-seq.\-c}!stbmm@{stbmm}}
\index{stbmm@{stbmm}!toeplitz_seq.c@{toeplitz\-\_\-seq.\-c}}
\subsubsection[{stbmm}]{\setlength{\rightskip}{0pt plus 5cm}int stbmm (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{nrow, }
\item[{int}]{m\-\_\-cw, }
\item[{int}]{m\-\_\-rw, }
\item[{Block $\ast$}]{tpltzblocks, }
\item[{int}]{nb\-\_\-blocks, }
\item[{int64\-\_\-t}]{idp, }
\item[{int}]{local\-\_\-\-V\-\_\-size, }
\item[{Flag}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}\label{toeplitz__seq_8c_ab51a5dfa887d47b4ce627eb0e01a2e0a}


Performs the multiplication of a symmetric, Toeplitz block-\/diagonal matrix, T, by an arbitrary matrix, V, distributed over processes in the generalized column-\/wise way. 

Each process performs the multiplication sequentially for each diagonal block and based on the sliding window algorithm. Prior to that M\-P\-I calls are used to exchange data between neighboring process. Each of the diagonal blocks is a symmetric, band-\/diagonal Toeplitz matrix, which can be different for each block. The parameters are \-: 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} distributed data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em nrow} & number of rows of the global data matrix V \\
\hline
{\em m} & number of columns for the data matrix V in the global rowwise order \\
\hline
{\em m\-\_\-rowwise} & number of columns for the data matrix V in the rowwise order per processor \\
\hline
{\em tpltzblocks} & list of the toeplitz blocks struture with its own parameters (idv, n, T\-\_\-block, lambda) \-: \\
\hline
{\em nb\-\_\-blocks} & number of Toeplitz blocks as stored in T \\
\hline
{\em idp} & global index of the first element of the local part of V \\
\hline
{\em local\-\_\-\-V\-\_\-size} & a number of all elements in local V \\
\hline
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line 121 of file toeplitz\-\_\-seq.\-c.

\index{toeplitz\-\_\-seq.\-c@{toeplitz\-\_\-seq.\-c}!gstbmm@{gstbmm}}
\index{gstbmm@{gstbmm}!toeplitz_seq.c@{toeplitz\-\_\-seq.\-c}}
\subsubsection[{gstbmm}]{\setlength{\rightskip}{0pt plus 5cm}int gstbmm (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{nrow, }
\item[{int}]{m\-\_\-cw, }
\item[{int}]{m\-\_\-rw, }
\item[{Block $\ast$}]{tpltzblocks, }
\item[{int}]{nb\-\_\-blocks, }
\item[{int64\-\_\-t}]{idp, }
\item[{int}]{local\-\_\-\-V\-\_\-size, }
\item[{int64\-\_\-t $\ast$}]{id0gap, }
\item[{int $\ast$}]{lgap, }
\item[{int}]{ngap, }
\item[{Flag}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}\label{toeplitz__seq_8c_a4cd10fd194db5a77c0366cddeda596ae}


Performs the multiplication of a symmetric, Toeplitz block-\/diagonal matrix with gaps, T, by an arbitrary matrix, V, distributed over processes. 

We first rebuild the Toeplitz block matrix structure to reduce the computation cost and skip the computations of the values on the defined gaps.

The parameters are \-: 
\begin{DoxyParams}{Parameters}
{\em V} & {\bfseries }\mbox{[}input\mbox{]} distributed data matrix (with the convention V(i,j)=V\mbox{[}i+j$\ast$n\mbox{]}) ; {\bfseries }\mbox{[}out\mbox{]} result of the product T\-V \\
\hline
{\em nrow} & number of rows of the global data matrix V \\
\hline
{\em m} & number of columns for the data matrix V in the global rowwise order \\
\hline
{\em m\-\_\-rowwise} & number of columns for the data matrix V in the rowwise order per processor \\
\hline
{\em tpltzblocks} & list of the toeplitz blocks struture with its own parameters (idv, n, T\-\_\-block, lambda) \-:
\begin{DoxyItemize}
\item idv is the global row index defining for each Toeplitz block as stored in the vector T ;
\item n size of each Toeplitz block
\item T\-\_\-block location of each Toeplitz matrix data composed of the non-\/zero entries of the first row ;
\item lambda size of each Toeplitz block data T\-\_\-block. The bandwith size is then equal to lambda$\ast$2-\/1 
\end{DoxyItemize}\\
\hline
{\em nb\-\_\-blocks\-\_\-all} & number of all Toeplitz block on the diagonal of the full Toeplitz matrix \\
\hline
{\em nb\-\_\-blocks\-\_\-local} & number of Toeplitz blocks as stored in T \\
\hline
{\em idp} & global index of the first element of the local part of V \\
\hline
{\em local\-\_\-\-V\-\_\-size} & a number of all elements in local V \\
\hline
{\em id0gap} & index of the first element of each defined gap \\
\hline
{\em lgap} & length of each defined gaps \\
\hline
{\em ngap} & number of defined gaps \\
\hline
{\em flag\-\_\-stgy} & flag strategy for the product computation \\
\hline
\end{DoxyParams}


Definition at line 170 of file toeplitz\-\_\-seq.\-c.

\index{toeplitz\-\_\-seq.\-c@{toeplitz\-\_\-seq.\-c}!gstbmm0@{gstbmm0}}
\index{gstbmm0@{gstbmm0}!toeplitz_seq.c@{toeplitz\-\_\-seq.\-c}}
\subsubsection[{gstbmm0}]{\setlength{\rightskip}{0pt plus 5cm}int gstbmm0 (
\begin{DoxyParamCaption}
\item[{double $\ast$$\ast$}]{V, }
\item[{int}]{nrow, }
\item[{int}]{m, }
\item[{int}]{m\-\_\-rowwise, }
\item[{Block $\ast$}]{tpltzblocks, }
\item[{int}]{nb\-\_\-blocks\-\_\-local, }
\item[{int}]{nb\-\_\-blocks\-\_\-all, }
\item[{int}]{id0p, }
\item[{int}]{local\-\_\-\-V\-\_\-size, }
\item[{int64\-\_\-t $\ast$}]{id0gap, }
\item[{int $\ast$}]{lgap, }
\item[{int}]{ngap, }
\item[{Flag}]{flag\-\_\-stgy}
\end{DoxyParamCaption}
)}\label{toeplitz__seq_8c_a5aa00da67c3344b6d0b9d3fdf24d5a1c}


Definition at line 186 of file toeplitz\-\_\-seq.\-c.

